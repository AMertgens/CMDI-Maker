<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>core\app.gui.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/APP.html">APP</a></li>
            
                <li><a href="../classes/APP.GUI.html">APP.GUI</a></li>
            
                <li><a href="../classes/APP.save_and_recall.html">APP.save_and_recall</a></li>
            
                <li><a href="../classes/HELPERS.html">HELPERS</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/CORE.html">CORE</a></li>
            
                <li><a href="../modules/HELPERS.html">HELPERS</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: core\app.gui.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
ï»¿/*
Copyright 2014 Sebastian Zimmer

Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

/**
 * A sub module of APP that deals with the GUI.
 *
 * @class APP.GUI
 */
APP.GUI = (function() {
	
	var l = APP.l;
	
	var my = {};
	
/**
 * Displays a busy indicator. (This feature is in pre-alpha state. Do not use it yet.)
 * @param parent Parent element
 * @method showBusyIndicator
 */	
	my.showBusyIndicator = function(parent){
	
		if (g(&quot;busy_div&quot;)){
			dom.remove(&quot;busy_div&quot;);
		}
		
		//g(&quot;environment_view&quot;).style.display = &quot;none&quot;;
		
		parent.innerHTML = &quot;&quot;;
	
		var busy_div = dom.div(parent, &quot;busy_div&quot;, &quot;busy_div&quot;);
		
		var p = dom.p(busy_div, &quot;&quot;, &quot;&quot;, &quot;center&quot;);
		
		var img = dom.img(p, &quot;busy_icon&quot;, &quot;busy_icon&quot;, &quot;img/busy.svg&quot;);
		
		img.width = &quot;700&quot;;
		img.height = &quot;300&quot;;
		
	}

/**
 * Hides the busy indicator again.  (This feature is in pre-alpha state. Do not use it yet.)
 * @method showBusyIndicator
 */
	my.hideBusyIndicator = function(){
	
		dom.remove(&quot;busy_div&quot;);
		
		g(&quot;environment_view&quot;).style.display = &quot;block&quot;;
	
	}

	
/**
 * Displays a busy indicator. (This feature is in pre-alpha state. Do not use it yet.)
 * @method setIcon
 * @param element DOM element of the icon (has to be be img)
 * @param icon_id Name of the icon.
 */	
	my.setIcon = function (element, icon_id){
	
		element.src = APP.CONF.path_to_icons + icon_id + &quot;.png&quot;;
	
	};

	
/**
 * Sets a value to a form element
 * @method setFormValue
 * @param element_id ID of DOM element
 * @param value Value
 * @param open_vocabulary If element is an open vocabulary, it should be provided here, too.
 */	
	my.setFormValue = function (element_id, value, open_vocabulary){

		var element = g(element_id);
		var new_element;
		
		if (!element){
			console.error(&quot;setFormValue: No element found! element_id = &quot; + element_id);
			return;
		}

		if (element.nodeName == &quot;SELECT&quot;){
		
			var options = [];
			
			forEach(element.options, function(option){
			
				options.push(option.value);
			
			});
			
			//if options of select contain do not contain the value, we have to change the input type to text
			if (options.indexOf(value) == -1){
		
				new_element = my.changeOVInput(element_id, options);
				new_element.value = value;
			
			}
			
			else {
			
				element.value = value;
				
			}
		
		}
		
		else {  //if element is not select
		
			//if the element is text input, but there&#x27;s an entry in the open vocabulary for the value
			//that&#x27;s great, because we can then go back to a select
			if ((element.type == &quot;text&quot;) &amp;&amp; (open_vocabulary) &amp;&amp; (open_vocabulary.indexOf(value) != -1)){
			
				new_element = my.changeOVInput(element_id, open_vocabulary);
				new_element.value = value;
			
			}
			
			else if (element.type == &quot;checkbox&quot;){
			
				element.checked = value;
			
			}
			
			else {
		
				element.value = value;
				
			}
		
		}

	};


/**
 * Creates a text input element with heading. Used a lot by APP.forms
 * @method makeTextInput
 * @param parent Parent element in DOM
 * @param {String} title Title or heading that is displayed above the form element
 * @param {String} name Name of the input element
 * @param {String} id ID of the input element
 * @param {String} value Value
 * @param {String} hover HTML Title Element value. This value is displayed as a tooltip when mouse is hovering above the element.
 * @param maxLength Maximum length of chars in element.
 * @return input Element that is to be created.
 */	
	my.makeTextInput = function (parent, title, name, id, value, hover, maxLength){

		var span = dom.spanBR(parent, &quot;&quot;, &quot;&quot;, title);
		
		if (hover){		
			span.title = hover;
		}

		var input = dom.input(parent, id, &quot;&quot;, name, &quot;text&quot;, value);
		
		if (hover){		
			input.title = hover;
		}
		
		if (maxLength){		
			input.maxLength = maxLength;
		}
		
		dom.br(parent);

		return input;	
		
	};
	

/**
 * Creates a text input element with heading. The element can be used to type year numbers.
 * @method makeYearInput
 * @param parent Parent element in DOM
 * @param {String} title Title or heading that is displayed above the form element
 * @param {String} name Name of the input element
 * @param {String} id ID of the input element 
 * @param {String} value Value
 * @param hover HTML Title Element value. This value is displayed as a tooltip when mouse is hovering above the element.
 * @return input Element that is to be created.
 */		
	my.makeYearInput = function (parent, title, name, id, value, hover){

		var span = dom.spanBR(parent, &quot;&quot;, &quot;&quot;, title);
		
		if (hover){		
			span.title = hover;
		}

		var input = dom.input(parent, id, &quot;YearInput&quot;, name, &quot;text&quot;, (value !== &quot;&quot;) ? value : &quot;YYYY&quot;);
		
		if (hover){		
			input.title = hover;
		}
		
		input.maxLength = 4;  //MaxLength of Year = 4
		
		dom.br(parent);

		return input;	
		
	};


/**
 * Creates an input element of type &quot;checkbox&quot; with a heading above the element.
 * @method makeCheckbox
 * @param parent Parent element in DOM
 * @param {String} title Title or heading that is displayed above the form element
 * @param {String} name Name of the input element
 * @param {String} id ID of the input element
 * @param {Boolean} checked Set to true if the checkbox is to be checked.
 * @param {String} hover HTML Title Element value. This value is displayed as a tooltip when mouse is hovering above the element.
 * @return input Element that is to be created.
 */	
	my.makeCheckbox = function (parent, title, name, id, checked, hover){

		var input = dom.input(parent, id, &quot;&quot;, name, &quot;checkbox&quot;);
		input.checked = checked;
		if (hover){		
			input.title = hover;
		}
		
		var span = dom.spanBR(parent,&quot;&quot;,&quot;&quot;,title);
		
		if (hover){
			span.title = hover;
		}

		return input;	
		
	};


/**
 * Creates a user input field where the user either can select an option from a given vocabulary or type in a custom option. As always, there is a heading above the element.
 * @method openVocabulary
 * @param parent Parent element in DOM
 * @param {String} title Title or heading that is displayed above the form element
 * @param {String} name Name of the input elements
 * @param {String} id ID of the input elements. Note that both select and input will have the same ID.
 * @param options Array with strings. Vocabulary of values.
 * @param {String} value Value of the input field. Note that if the value is part of options, the select element will be used, otherwise the text input element. 
 * @param {String} hover HTML Title Element value. This value is displayed as a tooltip when mouse is hovering above the element.
 * @param {String} className Class name of the select and input elements. 
 * @return return_object Returns an object that contains both the select and the input element. Keys are &quot;text&quot; and &quot;select&quot;.
 */	
	my.openVocabulary = function (parent, title, name, id, size, options, value, hover, className){

		if (!hover){
			hover = &quot;&quot;;
		}
		
		if (typeof title != &quot;undefined&quot;){
			var span = dom.spanBR(parent,&quot;&quot;,&quot;&quot;,title);
			span.title = hover;
		}

		var select = document.createElement(&quot;select&quot;);
		select.name = name;
		select.id = id;
		select.className = className;
		select.size = size;
		if (hover){		
			select.title = hover;
		}
		
		dom.setSelectOptions(select, options);
		
		if (typeof value != &quot;undefined&quot; &amp;&amp; options.indexOf(value) != -1) {
			select.selectedIndex = options.indexOf(value);
		}
		
		else {
			select.selectedIndex = 0;
		}


		var input = document.createElement(&quot;input&quot;);
		input.name = name;
		input.id = id;
		input.className = className;
		input.type = &quot;text&quot;;
		if (hover){		
			input.title = hover;
		}
		

		if ((typeof value == &quot;undefined&quot;) || (options.indexOf(value) != -1)) {	
			parent.appendChild(select);
		}
		
		else {
			input.value = value;
			parent.appendChild(input);
		}
		
		var img = my.icon(parent,&quot;&quot;,&quot;edit_img&quot;, &quot;textedit&quot;);
		img.alt = &quot;Custom Property&quot;;
		img.title = &quot;Custom Property&quot;;
		
		img.addEventListener(&quot;click&quot;, function(){
			
			if (document.contains(select)){
				dom.remove(select);
				parent.insertBefore(input,img);
			}
			
			else {
				dom.remove(img.previousSibling);
				parent.insertBefore(select,img);
			}
		
		});

		dom.br(parent);
		
		var return_object = {
			text: input,
			select: select
		};
		
		return return_object;

	};
	
	
/**
 * Creates a language search form, where the user can search a language or type in an ISO639-3 code to add a language somewhere.
 * @method makeLanguageSearchForm
 * @param parent Parent element in DOM
 * @param {String} element_id_prefix Prefix of the IDs of all elements that are created here.
 * @param {Boolean} no_br Set true, if there shall be no line break between the search input part and the add ISO part.
 * @param {Boolean} no_display Set true, if there shall no display element be created that could contain added languages to display.
 * @param on_select Callback function that is called, when the user adds a language.
 */		
	my.makeLanguageSearchForm = function(parent, element_id_prefix, no_br, no_display, on_select){
		var on_search = APP.doStandardLanguageSearch;
		var on_add_ISO = my.addLanguageByISOCode;
		
		var p = dom.make(&quot;p&quot;,&quot;&quot;, &quot;&quot;, parent);
		var input = dom.make(&quot;input&quot;, element_id_prefix + &quot;input&quot;,&quot;language_input&quot;,p);
		input.type = &quot;text&quot;;
		input.size = 1;
		input.name = element_id_prefix + &quot;input&quot;;
		
		dom.make(&quot;span&quot;,&quot;&quot;,&quot;&quot;,p,&quot; &quot;);
		var button = dom.make(&quot;input&quot;, element_id_prefix + &quot;search_button&quot; ,&quot;language_search_button&quot;,p);
		button.type = &quot;button&quot;;
		button.value = l(&quot;language_search&quot;, &quot;search&quot;);

		if (no_br &amp;&amp; no_br === true){
			dom.make(&quot;span&quot;,&quot;&quot;,&quot;&quot;,p,&quot; &quot;);
		}
		
		else {
			dom.br(p);
		}
		
		dom.make(&quot;span&quot;,&quot;&quot;,&quot;&quot;,p,l(&quot;language_search&quot;, &quot;or_type_in_iso_code&quot;) + &quot; &quot;);
		
		var iso_input = dom.make(&quot;input&quot;, element_id_prefix + &quot;iso_input&quot;,&quot;language_iso_input&quot;,p);
		iso_input.type = &quot;text&quot;;
		iso_input.size = 1;
		iso_input.name = element_id_prefix + &quot;iso_input&quot;;
		
		dom.make(&quot;span&quot;,&quot;&quot;,&quot;&quot;,p,&quot; &quot;);
		
		var iso_button = dom.make(&quot;input&quot;, element_id_prefix + &quot;iso_ok&quot;,&quot;language_iso_add_button&quot;,p);
		iso_button.type = &quot;button&quot;;
		iso_button.value = l(&quot;main&quot;, &quot;ok&quot;);			
		
		if (!no_display){
			dom.make(&quot;div&quot;,element_id_prefix + &quot;display&quot;, &quot;&quot;, parent);	
		}

		
		button.addEventListener(&#x27;click&#x27;, function() {  on_search(input.value, on_select);   });
		iso_button.addEventListener(&#x27;click&#x27;, function() {  on_add_ISO(iso_input, on_select);    });
		
		input.onkeydown = function(event) {
			if (event.keyCode == 13) {  //if enter is pressed
				on_search(input.value, on_select);
			}
		};
		
		iso_input.onkeydown = function(event) {
			if (event.keyCode == 13) {  //if enter is pressed
				on_add_ISO(iso_input, on_select);
			}
		};
		
	};
	
	
	my.addLanguageByISOCode = function(input_element, on_success){
		var input = input_element.value.toLowerCase();

		console.log(&quot;ADDING ISO LANGUAGE &quot; + input);
		
		for (var j=0;j&lt;LanguageIndex.length;j++){   //for all entries in LanguageIndex
		
			if ( (LanguageIndex[j][0] == input)  &amp;&amp;  (LanguageIndex[j][2] == &quot;L&quot;)){		//look for their l-name entry
				
				on_success(LanguageIndex[j]);
				
				input_element.value = &quot;&quot;;
				return;

			}

		}
		
		// the iso codes qaa ... qtz are reserved for local use and aren&#x27;t part of the LanguageIndex, check for them
		if (my.isISOCodeReservedForLocalUse(input) === true){
			on_success(
				[input, &quot;&quot;, &quot;LOCAL&quot;, &quot;&quot;]
			);
			
			input_element.value = &quot;&quot;;
			
			return;
		}
		
		APP.alert(l(&quot;languages&quot;, &quot;iso_code&quot;) + &quot; &quot; + input + &quot; &quot; + l(&quot;languages&quot;, &quot;not_found_in_db&quot;) + &quot;.&quot;);

	};
	

/**
 * Checks if an ISO code is reserved for local use. These are all ISO codes between &quot;qaa&quot; and &quot;qtz&quot;
 * @method isISOCodeReservedForLocalUse
 * @param {String} code ISO Code
 * @return answer True or false.
 */	
	my.isISOCodeReservedForLocalUse = function(code){
		//check for codes between qaa ... qtz
		
		if (code.length != 3){
			return false;
		}
		
		if (code[0] != &quot;q&quot;){
			return false;
		}
		
		if (&quot;abcdefghijklmnopqrst&quot;.indexOf(code[1]) == -1){
			return false;
		}
		
		if (&quot;abcdefghijklmnopqrstuvwxyz&quot;.indexOf(code[2]) == -1){
			return false;
		}
		
		return true;
	
	};
	
	
	my.icon = function(parent, id, className, icon, onclick){
	
		var img = dom.make(&quot;img&quot;,id,className,parent);
		my.setIcon(img, icon);
		
		if (onclick){
			img.addEventListener(&quot;click&quot;, onclick, false);
		}
		
		return img;	
	
	};
	
	
	my.copyField = function (target_element_name,source_element_name){

		var value = get(source_element_name);
		
		var source_element = document.getElementsByName(source_element_name)[0];
		var target_element = document.getElementsByName(target_element_name)[0];
		
		if (source_element.nodeName != target_element.nodeName){
			var options;
		
			if (source_element.nodeName == &quot;SELECT&quot;){
		
				options = my.getOptionValuesOfSelect(source_element);
				
			}

			var new_e = document.createElement(source_element.nodeName);
			new_e.name = target_element.name;
			new_e.className = target_element.className;

			target_element.parentNode.insertBefore(new_e,target_element);	
			dom.remove(target_element);
		
			if (new_e.nodeName == &quot;SELECT&quot;){
		
			
				dom.setSelectOptions(new_e, options);		
				new_e.selectedIndex = options.indexOf(value);
		
			}
			
			else {
			
				new_e.value = value;
			}
			
		}
		
		else {

			target_element.value = value;
		
		}
		
	};


	my.changeOVInput = function (id, options){
	//change input form of open vocabulary (=make select to text input and vice versa)
	//This method has to be changed!
	//my.openVocabulary creates already both elements select and text input.
	//Here we should make use of that and the fact, that data-binding has been
	//already applied to them
	
	
		var object = g(id);
		var new_object;
		
		
		if (object.nodeName == &quot;SELECT&quot;){

			new_object = document.createElement(&quot;input&quot;);
			new_object.type = &quot;text&quot;;
		
		}

		else {
		
			new_object = document.createElement(&quot;select&quot;);
			
			dom.setSelectOptions(new_object, options);
			
		}
		
		new_object.id = object.id;
		new_object.name = object.name;
		new_object.className = object.className;

		object.parentNode.insertBefore(new_object,object);
		
		dom.remove(object);
		
		return new_object;
		
	};


	my.makeSelect = function (parent, title, name, id, size, options, value, hover){
		//parameters: parent to append to, title, name of element, id of element, size, array of options
		
		if (!hover){
			hover = &quot;&quot;;
		}

		var span = dom.spanBR(parent, &quot;&quot;, &quot;&quot;, title);
		span.title = hover;
		
		var select = document.createElement(&quot;select&quot;);
		select.name = name;
		select.id = id;
		select.size = size;
		select.title = hover;
		
		parent.appendChild(select);
		
		dom.br(parent);
		
		dom.setSelectOptions(select, options);

		if (typeof value != &quot;undefined&quot; &amp;&amp; options.indexOf(value) != -1){
			select.selectedIndex = options.indexOf(value);
		}
		
		else {
			select.selectedIndex = 0;
		}

		return select;	

	};


	my.makeDateInput = function (parent, title, name_prefix, id_prefix, y_value, m_value, d_value, hover){
		var span;
		
		if (!hover){
			hover = &quot;&quot;;
		}

		span = dom.spanBR(parent,&quot;&quot;,&quot;&quot;,title);
		span.title = hover;
		
		var y_input = dom.input(parent, id_prefix+&quot;_year&quot;, &quot;YearInput&quot;, name_prefix+&quot;_year&quot;, &quot;text&quot;, (y_value !== &quot;&quot;) ? y_value : &quot;YYYY&quot;);
		y_input.title = hover;
		y_input.maxLength = 4;
		
		span = dom.span(parent, &quot;&quot;, &quot;&quot;, &quot; &quot;);
		span.title = hover;
		
		var m_input = dom.input(parent, id_prefix+&quot;_month&quot;, &quot;MonthInput&quot;, name_prefix+&quot;_month&quot;, &quot;text&quot;, (m_value !== &quot;&quot;) ? m_value : &quot;MM&quot;);
		m_input.title = hover;
		m_input.maxLength = 2;
		
		span = dom.span(parent, &quot;&quot;, &quot;&quot;, &quot; &quot;);
		span.title = hover;
		
		var d_input = dom.input(parent, id_prefix+&quot;_day&quot;, &quot;DayInput&quot;, name_prefix+&quot;_day&quot;, &quot;text&quot;, (d_value !== &quot;&quot;) ? d_value : &quot;DD&quot;);
		d_input.title = hover;
		d_input.maxLength = 2;
		
		dom.br(parent);
		
		return_object = {
			year: y_input,
			month: m_input,
			day: d_input
		};
		
		return return_object;
		
	};


	my.makeTextarea = function (t_cols,t_rows,parent,title,t_name,t_id,t_class,t_value, hover){

		if (!hover){
			hover = &quot;&quot;;
		}
		
		var span = dom.spanBR(parent, &quot;&quot;, &quot;&quot;, title);
		span.title = hover;
		
		var textarea = dom.make(&quot;textarea&quot;, t_id, t_class, parent);
		textarea.name = t_name;
		textarea.value = t_value;
		textarea.cols = t_cols;
		textarea.rows = t_rows;
		textarea.title = hover;
		
		dom.br(parent);
		
		return textarea;
		
	};


	my.makeAllFunctionsInvisible = function(){
	
		//make all functions invisible
		var functions = g(APP.CONF.functions_div_id).children;
		forEach(functions, dom.hideElement);
	
	};
	
	
	my.hideFunctionsDIV = function(){
	
		g(APP.CONF.functions_div_id).style.height = &quot;0px&quot;;
		g(APP.CONF.content_wrapper_id).style.bottom = &quot;0px&quot;;
		
		if (g(APP.CONF.log_section_id)){
			g(APP.CONF.log_section_id).style.bottom = &quot;10px&quot;;
		}
	
	};
	
	
	my.showFunctionsDIV = function(){
	
		g(APP.CONF.functions_div_id).style.height = APP.CONF.functions_div_height;
		g(APP.CONF.content_wrapper_id).style.bottom = APP.CONF.functions_div_height;
		
		if (g(APP.CONF.log_section_id)){
			g(APP.CONF.log_section_id).style.bottom = &quot;50px&quot;;
		}
	
	};	
	
	
	my.showFunctionsForView = function (module){

		my.makeAllFunctionsInvisible();
		
		//If this view is not from a module, it wont have functions
		if (!module){
			my.hideFunctionsDIV();
			return;
		}

		//if this module has functions, make them visible
		if (module.functions){
		
			my.showFunctionsDIV();
			
			var functions = module.functions;
			
			if (typeof functions == &quot;function&quot;){
				functions = functions();
			}

			forEach(functions, my.renderFunctionIfNotDisabled);
			
		}

	};
	
	
	my.renderFunctionIfNotDisabled = function(func){
		var id;
		
		if (func.type == &quot;function_wrap&quot;){
		
			id = func.wrapper_id;
		
		}
		
		else {
		
			id = func.id;
			
		}
		
		if (APP.environments.disabled_functions.indexOf(id) != -1){
			return;
		}
		
		my.renderFunction(func);
	
	};
	
	
	my.renderFunction = function (func){
	
		if (func.type == &quot;function_wrap&quot;){
			
			g(func.wrapper_id).style.display = &quot;inline&quot;;
			
			//set the sub_div to same width and position as function_div
			var rect = g(func.wrapper_id).children[0].getBoundingClientRect();
			g(func.wrapper_id).children[1].style.left = rect.left + &quot;px&quot;;
			g(func.wrapper_id).children[1].style.minWidth = (rect.width - 30) + &quot;px&quot;;
			//-30 because of the 15px border of sub_divs

		}
		
		else {
			g(func.id).style.display = &quot;inline&quot;;
		}
		
	};
	
	
	my.switchToggle = function(input){

		if (input.on === false){
			my.setToggleValue(input, true);
		}
		
		else {
			my.setToggleValue(input, false);
		}		
	};
	
	
	my.setToggleValue = function(input, value){
	
		if (value === true){
			input.value = APP.l(&quot;main&quot;, &quot;on&quot;);
			input.style.backgroundColor = APP.CONF.toggle_color_on;
			input.on = true;
		}
		
		else {
			input.value = APP.l(&quot;main&quot;, &quot;off&quot;);
			input.style.backgroundColor = APP.CONF.toggle_color_off;
			input.on = false;
		}		
	
	};
	
	
	my.showSelectFrame = function(options, titles, callback, title, subtitle){
	//options are the parameters for the callback method
	
		var old_view = APP.active_view;
		
		//create new view for select frame or get old one
		if (g(&quot;VIEW_SF&quot;)){
			var SF_view = g(&quot;VIEW_SF&quot;);
			SF_view.innerHTML = &quot;&quot;;
		}
		
		else {
			
			SF_view = dom.div(g(&quot;content_wrapper&quot;), &quot;VIEW_SF&quot;, &quot;content&quot;);
			
		}
		
		var frame = dom.make(&quot;div&quot;,APP.CONF.select_frame_id,APP.CONF.select_frame_id,SF_view,&quot;&quot;);	
		frame.style.display = &quot;block&quot;;
		
		dom.make(&quot;h1&quot;,&quot;&quot;,&quot;&quot;,frame,title); 
		
		var img = dom.make(&quot;img&quot;,&quot;&quot;,&quot;close_select_frame_icon&quot;,frame);
		img.src = APP.CONF.path_to_icons + &quot;reset.png&quot;;
		img.addEventListener(&#x27;click&#x27;, function() { 
			//go back to old view
			APP.view(old_view); 
		} );
		
		dom.h3(frame,subtitle);
		
		for (var j=0; j&lt;options.length; j++){
		
			var a = dom.link(frame,&#x27;cl_results_link_&#x27;+j,&#x27;cl_results_link&#x27;,&quot;&quot;,function(num) {
				return function(){
					callback(num);
					
					//go back to old view
					APP.view(old_view);
				};
			}(options[j]));
			
			dom.make(&quot;div&quot;,&quot;&quot;,&#x27;SF_search_entry&#x27;,a,titles[j]);

		}
		
		APP.view(&quot;VIEW_SF&quot;);
	
	};
	
	
	my.scrollTop = function(){
	
		dom.scrollTop(g(APP.CONF.content_wrapper_id));
	
	};
	
	
	my.createXMLOutputDIV = function (parent, title, textarea_id, value, filename, mockup, http_post_information){

		var div = dom.make(&quot;div&quot;, &quot;&quot;, &quot;output_div&quot;, parent);
		
		var img = my.icon(div,&quot;&quot;,&quot;download_icon xml_output_area_icon&quot;, &quot;save&quot;);
		
		if (typeof http_post_information != &quot;undefined&quot;){
			var post_img = my.icon(div,&quot;&quot;,&quot;download_icon xml_output_area_icon&quot;, &quot;send_mail&quot;);
			
			post_img.title = &quot;Post data to server&quot;;
			
		}
		
		var h1 = dom.h1(div, title);
		
		var textarea = dom.textarea(div, textarea_id, APP.CONF.xml_textarea_class_name, 
		APP.CONF.output_textarea_rows, APP.CONF.output_textarea_columns, value);
		
		//Sanitize filename
		filename = strings.replaceAccentBearingLettersWithASCISubstitute(filename);
		filename = strings.removeAllCharactersFromStringExcept(filename, APP.CONF.valid_chars_for_filename);
		
		textarea.filename = filename;
		
		img.addEventListener(&quot;click&quot;, function(){
			APP.saveTextfile(textarea.value, filename, APP.CONF.file_download_header);
		});
		
		
		if (typeof http_post_information != &quot;undefined&quot;){
			
			var xml_in_one_line = strings.removeCharactersFromString(textarea.value, &quot;\r\n&quot;);
			
			var post_data = http_post_information.xml_string_key + &quot;=&quot; + xml_in_one_line + &quot;&amp;&quot; + http_post_information.additional_data;			
			
			post_img.addEventListener(&quot;click&quot;, function(){
				postWithAJAX(
					http_post_information.url,
					post_data,
					function(){APP.log(&quot;Data saved on server!&quot;, &quot;success&quot;);},
					http_post_information.additional_headers
				);					
			});			
		}
		
		if (mockup &amp;&amp; mockup === true){
			console.warn(&quot;Created invalid XML&quot;);
			div.style.backgroundColor = &quot;tomato&quot;;
			h1.style.color = &quot;#AA0000&quot;;
			textarea.style.color = &quot;red&quot;;
			h1.innerHTML += &quot; - INVALID XML!&quot;;
			textarea.value = &quot;############################################################################\n&quot;+
			&quot;WARNING: THE FOLLOWING XML IS NOT VALID AND MEANT ONLY FOR TESTING PURPOSES!\n&quot;+
			&quot;############################################################################\n&quot;+
			value;
			dom.remove(img);
		}
		
		

	};
	
	
	my.highlightViewIcon = function (id) {
		
		if (typeof APP.environments.active_environment != &quot;undefined&quot;){
		
			//Unhighlight all workflow icons
			forEach(APP.environments.active_environment.workflow, function(workflow){
				g(APP.CONF.viewlink_id_prefix + workflow.identity.id).style.backgroundColor = &quot;&quot;;
			});
		}

		//Unhighlight APP VIEWLINKS
		g(APP.CONF.viewlink_id_prefix + &quot;start&quot;).style.backgroundColor = &quot;&quot;;
		
		var module = APP.environments.getModuleByViewID(id);
		
		if (module){
			g(APP.CONF.viewlink_id_prefix + module.identity.id).style.backgroundColor = APP.CONF.highlight_color;
		}
		
		else if (id == &quot;VIEW_start&quot;){
			id = id.substr(APP.CONF.view_id_prefix.length);
			g(APP.CONF.viewlink_id_prefix+id).style.backgroundColor = APP.CONF.highlight_color;
		}

	};
	
	
	my.mainMenu = (function() {
		
		var my = {};
		
		my.drawElement = function(element, parent){
			
			var div = dom.div(parent, element.id, &quot;main_menu_entry&quot;);
			APP.GUI.icon(div, &quot;&quot;, &quot;main_menu_entry_img&quot;, element.icon);
			dom.span(div, &quot;&quot;, &quot;main_menu_entry_span&quot;, element.title);
			
			div.addEventListener(&quot;click&quot;, element.onclick, false);
			div.addEventListener(&quot;click&quot;, my.close, false);
			
		};	
		
		my.draw = function(menu_elements){
			var menu;
			
			//if main menu already exists
			if (g(APP.CONF.main_menu_div_id)){
				menu = g(APP.CONF.main_menu_div_id);
				menu.innerHTML = &quot;&quot;;
			}
			
			else {
				menu = dom.div(document.body, APP.CONF.main_menu_div_id, &quot;&quot;);
			}
			
			forEach(menu_elements, function(element){ my.drawElement(element, menu); });
			
			my.close();
			
			g(&quot;main_menu_icon&quot;).addEventListener(&quot;click&quot;, my.changeDisplay);
			g(&quot;content_wrapper&quot;).addEventListener(&quot;click&quot;, my.close);
		};
		
		
		my.changeDisplay = function(){
		
			if (g(APP.CONF.main_menu_div_id).style.display == &quot;none&quot;){
				my.open();
			}
			
			else {
				my.close();
			}
			
		
		};
		
		
		my.close = function(){
			
			if (!g(APP.CONF.main_menu_div_id)){
				return;
			}
			
			dom.hideElement(g(APP.CONF.main_menu_div_id));
			g(&quot;main_menu_icon&quot;).style.backgroundColor = &quot;&quot;;
			
		};
		
		
		my.open = function(){

			g(APP.CONF.main_menu_div_id).style.display = &quot;block&quot;;
			g(&quot;main_menu_icon&quot;).style.backgroundColor = &quot;cornflowerblue&quot;;
		
		};
		
		return my;
		
	})();
	
	
	my.showFileDialog = function(onchange){
	
		alertify.set({ labels: {
			ok     : APP.l(&quot;main&quot;, &quot;abort&quot;)
		} });
		
		var innerHTML = &quot;&lt;input type=&#x27;file&#x27; id=&#x27;generic_file_input&#x27;&gt;&quot;;
		
		
		alertify.alert(innerHTML);
	
		g(&quot;generic_file_input&quot;).addEventListener(&quot;change&quot;, function(evt){
		
			var file = evt.target.files[0];
			
			onchange(file);
			
			g(&quot;alertify-ok&quot;).click();  //dirty, but it works!
			
		});
	
	};
	
	
	my.selectionMechanism = function (file_entry_prefix, selected_flag_in_className, callback){
	//This constructor function provides a selection mechanism for objects in the GUI.
	//SHIFT = Select multiple resources
	//ESCAPE = Deselect all resources
	
		var self = this;
		
		this.shift = false;
		this.last_selected_file = -1;
		this.selected_files = [];
		
		this.selectFile = function(i){

			var pos = self.selected_files.indexOf(i);

			if (pos == -1){
				self.selected_files.push(i);
				self.last_selected_file = i;
			}
			
			else {
				self.selected_files.splice(pos,1);
				self.last_selected_file = i;
			}

			self.markFileEntry(i);

		};
		
		
		this.markFileEntry = function(i){
			var event;

			var pos = g(file_entry_prefix + i).className.indexOf(&quot; &quot; + selected_flag_in_className);
			
			if (pos == -1) {
				
				g(file_entry_prefix + i).className = g(file_entry_prefix + i).className + &quot; &quot; + selected_flag_in_className;
				
				event = {
					index: i,
					selected: true
				};
				
			}
			
			else {
			
				g(file_entry_prefix + i).className = g(file_entry_prefix + i).className.slice(0,pos);
				
				event = {
					index: i,
					selected: false
				};
				
			}
			
			callback(event);

		};
		
		
		this.deselectAllFiles = function(){

			while (self.selected_files.length &gt; 0){
			
				self.selectFile(self.selected_files[0]);
			
			}

		};
		
		
		this.clickedOnFile = function(i){
			var f;
			
			if (self.shift === true){
				
				if (i &lt; self.last_selected_file){
				
					for (f = self.last_selected_file-1; f&gt;=i; f--){
				
						self.selectFile(f);
				
					}		
				
				}
				
				if (i &gt; self.last_selected_file){
				
					for (f = self.last_selected_file+1; f&lt;=i; f++){
				
						self.selectFile(f);
				
					}
				}
				
			}
			
			else {
				self.selectFile(i);	
			}

		};
		
		
		document.onkeydown = function(event) {
		
			if (event.keyCode == 16) {  //if shift is pressed
				if (self.shift === false){
					self.shift = true;
					console.log(&quot;shift on&quot;);
				}
			}
			
			if (event.keyCode == 27)  {   //escape pressed
			
				self.deselectAllFiles();
			
			}
		
		};
		
		
		document.onkeyup = function(event) {
		
			if (event.keyCode == 16) {  //if shift is let go
				self.shift = false;
				console.log(&quot;shift off&quot;);
			}
			
		};
	
	};
	
	
	return my;
	
})();


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
