function postWithAJAX(e,t,n){var i=new XMLHttpRequest;return i.open("POST",e,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(console.log("AJAX successful!"),n(i))},console.log("Sending ajax request to: "+e),i.send(t)}function getWithAJAX(e,t){var n=new XMLHttpRequest;return n.open("GET",e,!0),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&(console.log("AJAX successful!"),t(n))},console.log("Sending ajax request to: "+e),n.send()}function getTextWithAJAX(e,t){return getWithAJAX(e,function(e){var n=e.responseText;t(n)})}function getJSONWithAJAX(e,t){getTextWithAJAX(e,function(e){parseJSON(e,t,void 0)})}function cloneObject(e){var t={};Array.isArray(e)&&(t=[]);for(var n in e)t[n]=e[n]&&"object"==typeof e[n]?cloneObject(e[n]):e[n];return t}function readFileAsText(e,t){var n=new FileReader;n.onload=function(e){var n=e.target.result;t(n)},n.readAsText(e)}function parseJSON(e,t,n){var i;try{i=JSON.parse(e)}catch(r){return log("parseJSON: String is not valid JSON"),void("function"==typeof n&&n(r))}return"undefined"==typeof i?(log("parseJSON: String is not valid JSON"),void("function"==typeof n&&n())):void t(i)}function readFileAsJSON(e,t,n){readFileAsText(e,function(e){parseJSON(e,t,n)})}function addScript(e,t,n){var i=document.createElement("script");i.src=e,i.async=n||!1,console.log("adding script: "+e+", async="+i.async),t&&i.addEventListener("load",t,!1),document.head.appendChild(i),i.addEventListener("load",function(){console.log("script "+e+" ready!")},!1)}function addStylesheet(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),"undefined"!=typeof t&&document.getElementsByTagName("head")[0].appendChild(t)}function get(e){var t=document.getElementsByName(e);if(t[0]&&"INPUT"==t[0].nodeName&&"radio"==t[0].type)return getSelectedRadioValue(t);if(t=t[0],"undefined"==typeof t&&(t=g(e)),"undefined"==typeof t)return void console.error("get: Element "+e+" is undefined!");switch(t.nodeName){case"INPUT":return t.value;case"TEXTAREA":return t.value;case"SELECT":return-1!=t.selectedIndex?t.options[t.selectedIndex].value:"";default:console.log('Function "get" has been misused with a '+t.nodeName+" element. This should not have happened!")}}function g_value(e){return document.getElementById(e).options[document.getElementById(e).options.selectedIndex].value}function o(e,t){for(var n=e,i=0;i<t.length;i++){if(!(t[i]in n))return"";n=n[t[i]]}return n}function a(e,t){for(var n=[],i=0;i<e.length;i++)n.push(e[i][t]);return n}function sortBySubKey(e,t){return e.sort(function(e,n){var i=e[t[0]][t[1]],r=n[t[0]][t[1]];return"string"==typeof i&&(i=i.toLowerCase(),r=r.toLowerCase()),r>i?-1:i>r?1:0})}function sortByKey(e,t){return e.sort(function(e,n){var i=e[t],r=n[t];return"string"==typeof i&&(i=i.toLowerCase(),r=r.toLowerCase()),r>i?-1:i>r?1:0})}var dates=function(){var e={};return e.today=function(){var e=new Date,t=e.getDate();10>t&&(t="0"+t);var n=e.getMonth();n+=1,10>n&&(n="0"+n);var i=e.getFullYear()+"-"+n+"-"+t;return i},e.calcAgeAtDate=function(e,t){var n=+new Date(e),i=+new Date(t);return~~((n-i)/315576e5)},e.getTimezoneOffsetInHours=function(){function e(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}var t=(new Date).getTimezoneOffset();return t=(0>t?"+":"-")+e(parseInt(Math.abs(t/60)),2)+":"+e(Math.abs(t%60),2)},e.getDateStringByDateInput=function(t){var n={};return n.year=g(t+"_year").value,n.month=g(t+"_month").value,n.day=g(t+"_day").value,e.getDateStringByDateObject(n)},e.getDateStringByDateObject=function(e){if(!e||!e.month||!e.day)return void console.error("date object is not valid");var t="0123456789";return("string"!=typeof e.year||4==e.year.length&&strings.areOnlyTheseCharsInString(e.year,t))&&("string"!=typeof e.month||2==e.month.length&&strings.areOnlyTheseCharsInString(e.month,t))&&("string"!=typeof e.day||2==e.day.length&&strings.areOnlyTheseCharsInString(e.day,t))?e.year+"-"+e.month+"-"+e.day:void 0},e.isUserDefinedDateInvalid=function(t){var n,i,r,o;if("string"==typeof t){var a=t;n=get(a+"_year"),i=get(a+"_month"),r=get(a+"_day"),o=typeof e.getDateStringByDateInput(a)}else{var l=t;n=l.year,i=l.month,r=l.day,o=typeof e.getDateStringByDateObject(l)}return"undefined"!=o||"YYYY"==n&&"MM"==i&&"DD"==r?!1:!0},e.parseDate=function(e){var t;if("undefined"==typeof e)return null;var n=e.match(/([1-2][0-9][0-9][0-9])\-([0-1][0-9])\-([0-3][0-9])/);if(null!==n){var i=+n[1],r=+n[2],o=+n[3];if(t=new Date(i,r-1,o),t.getFullYear()===i&&t.getMonth()===r-1)return{year:n[1],month:n[2],day:n[3]}}var a=e.match(/(\d+)/g);return null!==a&&(t=new Date(a[2],a[1]-1,a[0]),t.getFullYear()==a[2]&&t.getMonth()==a[1]-1)?{year:a[2],month:a[1],day:a[0]}:null},e.dateAsString=function(e){var t=e.year,n=e.month,i=e.day;return 10>n&&(n="0"+n),10>i&&(i="0"+i),t+"-"+n+"-"+i},e}(),addFile=function(e){"js"==strings.getFileTypeFromFilename(e)&&addScript(e),"css"==strings.getFileTypeFromFilename(e)&&addStylesheet(e)},addFiles=function(e,t){return"string"==typeof e?(t&&(e=t+e),void addFile(e)):Array.isArray(e)?void forEach(e,function(e){t&&(e=t+e),addFile(e)}):void 0},getIndex=function(e,t,n){for(var i=0;i<e.length;i++)if(e[i][t]==n)return i;return void 0},getIndexByID=function(e,t){return getIndex(e,"id",t)},getObject=function(e,t,n){for(var i=0;i<e.length;i++)if(e[i][t]==n)return e[i];return void 0},getObjectByID=function(e,t){return getObject(e,"id",t)},forAllItems=function(e,t){for(var n=e.length;;){if(0===n)return;n-=1,t(e[n])}},map=function(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i]));return n},getArrayWithValuesByKey=function(e,t){var n=map(e,function(e){return e[t]});return n},getArrayWithIDs=function(e){return getArrayWithValuesByKey(e,"id")},filter=function(e,t){for(var n=[],i=0;i<e.length;i++)t(e[i])&&n.push(e[i]);return n},forEach=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},getSelectedRadioIndex=function(e){for(var t=0;t<e.length;t++)if(e[t].checked===!0)return t;return 0},log=function(e){console.log(e)},getSelectedRadioValue=function(e){return"string"==typeof e&&(e=document.getElementsByName(e)),e[getSelectedRadioIndex(e)].value},g=function(e){return document.getElementById(e)?document.getElementById(e):document.getElementsByName(e).length>0?document.getElementsByName(e):void 0},removeToInsertLater=function(e){var t=e.parentNode,n=e.nextSibling;return t.removeChild(e),function(){n?t.insertBefore(e,n):t.appendChild(e)}};!function(e,t){"use strict";var n,i=e.document;n=function(){var n,r,o,a,l,s,c,d,u,f,g,v,m,_={},p={},h=!1,y={ENTER:13,ESC:27,SPACE:32},P=[];return p={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}</nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',message:'<p class="alertify-message">{{message}}</p>',log:'<article class="alertify-log{{class}}">{{message}}</article>'},m=function(){var e,n,r=!1,o=i.createElement("fakeelement"),a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(e in a)if(o.style[e]!==t){n=a[e],r=!0;break}return{type:n,supported:r}},n=function(e){return i.getElementById(e)},_={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:t,addListeners:function(e){var t,n,s,c,d,u="undefined"!=typeof o,f="undefined"!=typeof r,g="undefined"!=typeof v,m="",_=this;t=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),s(t),"undefined"!=typeof v&&(m=v.value),"function"==typeof e&&("undefined"!=typeof v?e(!0,m):e(!0)),!1},n=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),s(t),"function"==typeof e&&e(!1),!1},s=function(){_.hide(),_.unbind(i.body,"keyup",c),_.unbind(a,"focus",d),u&&_.unbind(o,"click",t),f&&_.unbind(r,"click",n)},c=function(e){var i=e.keyCode;(i===y.SPACE&&!g||g&&i===y.ENTER)&&t(e),i===y.ESC&&f&&n(e)},d=function(){g?v.focus():!f||_.buttonReverse?o.focus():r.focus()},this.bind(a,"focus",d),this.bind(l,"focus",d),u&&this.bind(o,"click",t),f&&this.bind(r,"click",n),this.bind(i.body,"keyup",c),this.transition.supported||this.setFocus()},bind:function(e,t,n){"function"==typeof e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},handleErrors:function(){if("undefined"!=typeof e.onerror){var t=this;return e.onerror=function(e,n,i){t.error("["+e+" on line "+i+" of "+n+"]",0)},!0}return!1},appendButtons:function(e,t){return this.buttonReverse?t+e:e+t},build:function(e){var t="",n=e.type,i=e.message,r=e.cssClass||"";switch(t+='<div class="alertify-dialog">',t+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>',"none"===_.buttonFocus&&(t+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'),"prompt"===n&&(t+='<div id="alertify-form">'),t+='<article class="alertify-inner">',t+=p.message.replace("{{message}}",i),"prompt"===n&&(t+=p.input),t+=p.buttons.holder,t+="</article>","prompt"===n&&(t+="</div>"),t+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>',t+="</div>",n){case"confirm":t=t.replace("{{buttons}}",this.appendButtons(p.buttons.cancel,p.buttons.ok)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"prompt":t=t.replace("{{buttons}}",this.appendButtons(p.buttons.cancel,p.buttons.submit)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"alert":t=t.replace("{{buttons}}",p.buttons.ok),t=t.replace("{{ok}}",this.labels.ok)}return u.className="alertify alertify-"+n+" "+r,d.className="alertify-cover",t},close:function(e,t){var n,i,r=t&&!isNaN(t)?+t:this.delay,o=this;this.bind(e,"click",function(){n(e)}),i=function(e){e.stopPropagation(),o.unbind(this,o.transition.type,i),f.removeChild(this),f.hasChildNodes()||(f.className+=" alertify-logs-hidden")},n=function(e){"undefined"!=typeof e&&e.parentNode===f&&(o.transition.supported?(o.bind(e,o.transition.type,i),e.className+=" alertify-log-hide"):(f.removeChild(e),f.hasChildNodes()||(f.className+=" alertify-logs-hidden")))},0!==t&&setTimeout(function(){n(e)},r)},dialog:function(e,t,n,r,o){c=i.activeElement;var a=function(){f&&null!==f.scrollTop&&d&&null!==d.scrollTop||a()};if("string"!=typeof e)throw new Error("message must be a string");if("string"!=typeof t)throw new Error("type must be a string");if("undefined"!=typeof n&&"function"!=typeof n)throw new Error("fn must be a function");return this.init(),a(),P.push({type:t,message:e,callback:n,placeholder:r,cssClass:o}),h||this.setup(),this},extend:function(e){if("string"!=typeof e)throw new Error("extend method must have exactly one paramter");return function(t,n){return this.log(t,e,n),this}},hide:function(){var e,t=this;P.splice(0,1),P.length>0?this.setup(!0):(h=!1,e=function(n){n.stopPropagation(),t.unbind(u,t.transition.type,e)},this.transition.supported?(this.bind(u,this.transition.type,e),u.className="alertify alertify-hide alertify-hidden"):u.className="alertify alertify-hide alertify-hidden alertify-isHidden",d.className="alertify-cover alertify-cover-hidden",c.focus())},init:function(){i.createElement("nav"),i.createElement("article"),i.createElement("section"),null==n("alertify-cover")&&(d=i.createElement("div"),d.setAttribute("id","alertify-cover"),d.className="alertify-cover alertify-cover-hidden",i.body.appendChild(d)),null==n("alertify")&&(h=!1,P=[],u=i.createElement("section"),u.setAttribute("id","alertify"),u.className="alertify alertify-hidden",i.body.appendChild(u)),null==n("alertify-logs")&&(f=i.createElement("section"),f.setAttribute("id","alertify-logs"),f.className="alertify-logs alertify-logs-hidden",i.body.appendChild(f)),i.body.setAttribute("tabindex","0"),this.transition=m()},log:function(e,t,n){var i=function(){f&&null!==f.scrollTop||i()};return this.init(),i(),f.className="alertify-logs",this.notify(e,t,n),this},notify:function(e,t,n){var r=i.createElement("article");r.className="alertify-log"+("string"==typeof t&&""!==t?" alertify-log-"+t:""),r.innerHTML=e,f.appendChild(r),setTimeout(function(){r.className=r.className+" alertify-log-show"},50),this.close(r,n)},set:function(e){var t;if("object"!=typeof e&&e instanceof Array)throw new Error("args must be an object");for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},setFocus:function(){v?(v.focus(),v.select()):s.focus()},setup:function(e){var i,c=P[0],d=this;h=!0,i=function(e){e.stopPropagation(),d.setFocus(),d.unbind(u,d.transition.type,i)},this.transition.supported&&!e&&this.bind(u,this.transition.type,i),u.innerHTML=this.build(c),a=n("alertify-resetFocus"),l=n("alertify-resetFocusBack"),o=n("alertify-ok")||t,r=n("alertify-cancel")||t,s="cancel"===_.buttonFocus?r:"none"===_.buttonFocus?n("alertify-noneFocus"):o,v=n("alertify-text")||t,g=n("alertify-form")||t,"string"==typeof c.placeholder&&""!==c.placeholder&&(v.value=c.placeholder),e&&this.setFocus(),this.addListeners(c.callback)},unbind:function(e,t,n){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}},{alert:function(e,t,n){return _.dialog(e,"alert",t,"",n),this},confirm:function(e,t,n){return _.dialog(e,"confirm",t,"",n),this},extend:_.extend,init:_.init,log:function(e,t,n){return _.log(e,t,n),this},prompt:function(e,t,n,i){return _.dialog(e,"prompt",t,n,i),this},success:function(e,t){return _.log(e,"success",t),this},error:function(e,t){return _.log(e,"error",t),this},set:function(e){_.set(e)},labels:_.labels,debug:_.handleErrors}},"function"==typeof define?define([],function(){return new n}):"undefined"==typeof e.alertify&&(e.alertify=new n)}(this),function(e){function t(){var e=-1,t=this;t.append=function(n){var i,r=t.table;for(i=0;i<n.length;i++)e=e>>>8^r[255&(e^n[i])]},t.get=function(){return~e}}function n(e,t,n){return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}function i(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function r(){}function o(e){function t(t,n){var o=new Blob([e],{type:U});i=new l(o),i.init(function(){r.size=i.size,t()},n)}function n(e,t,n,r){i.readUint8Array(e,t,n,r)}var i,r=this;r.size=0,r.init=t,r.readUint8Array=n}function a(t){function n(e){for(var n=t.length;"="==t.charAt(n-1);)n--;o=t.indexOf(",")+1,a.size=Math.floor(.75*(n-o)),e()}function r(n,r,a){var l,s=i(r),c=4*Math.floor(n/3),d=4*Math.ceil((n+r)/3),u=e.atob(t.substring(c+o,d+o)),f=n-3*Math.floor(c/4);for(l=f;f+r>l;l++)s.array[l-f]=u.charCodeAt(l);a(s.array)}var o,a=this;a.size=0,a.init=n,a.readUint8Array=r}function l(e){function t(t){this.size=e.size,t()}function i(t,i,r,o){var a=new FileReader;a.onload=function(e){r(new Uint8Array(e.target.result))},a.onerror=o,a.readAsArrayBuffer(n(e,t,i))}var r=this;r.size=0,r.init=t,r.readUint8Array=i}function s(){}function c(e){function t(e){r=new Blob([],{type:U}),e()}function n(e,t){r=new Blob([r,F?e:e.buffer],{type:U}),t()}function i(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=n,i.readAsText(r,e)}var r,o=this;o.init=t,o.writeUint8Array=n,o.getData=i}function d(t){function n(e){a+="data:"+(t||"")+";base64,",e()}function i(t,n){var i,r=l.length,o=l;for(l="",i=0;i<3*Math.floor((r+t.length)/3)-r;i++)o+=String.fromCharCode(t[i]);for(;i<t.length;i++)l+=String.fromCharCode(t[i]);o.length>2?a+=e.btoa(o):l=o,n()}function r(t){t(a+e.btoa(l))}var o=this,a="",l="";o.init=n,o.writeUint8Array=i,o.getData=r}function u(e){function t(t){r=new Blob([],{type:e}),t()}function n(t,n){r=new Blob([r,F?t:t.buffer],{type:e}),n()}function i(e){e(r)}var r,o=this;o.init=t,o.writeUint8Array=n,o.getData=i}function f(e,t,n,i,r,o,a,l,s,c){function d(){e.removeEventListener(R,u,!1),l(v)}function u(e){var t=e.data,i=t.data;t.onappend&&(v+=i.length,n.writeUint8Array(i,function(){o(!1,i),f()},c)),t.onflush&&(i?(v+=i.length,n.writeUint8Array(i,function(){o(!1,i),d()},c)):d()),t.progress&&a&&a(g+t.current,r)}function f(){g=m*T,r>g?t.readUint8Array(i+g,Math.min(T,r-g),function(t){e.postMessage({append:!0,data:t}),m++,a&&a(g,r),o(!0,t)},s):e.postMessage({flush:!0})}var g,v,m=0;v=0,e.addEventListener(R,u,!1),f()}function g(e,t,n,i,r,o,a,l,s,c){function d(){var v;u=f*T,r>u?t.readUint8Array(i+u,Math.min(T,r-u),function(t){var l=e.append(t,function(){a&&a(i+u,r)});g+=l.length,o(!0,t),n.writeUint8Array(l,function(){o(!1,l),f++,setTimeout(d,1)},c),a&&a(u,r)},s):(v=e.flush(),v?(g+=v.length,n.writeUint8Array(v,function(){o(!1,v),l(g)},c)):l(g))}var u,f=0,g=0;d()}function v(n,i,r,o,a,l,s,c,d){function u(e,t){a&&!e&&_.append(t)}function v(e){l(e,_.get())}var m,_=new t;return e.zip.useWebWorkers?(m=new Worker(e.zip.workerScriptsPath+M),f(m,n,i,r,o,u,s,v,c,d)):g(new e.zip.Inflater,n,i,r,o,u,s,v,c,d),m}function m(n,i,r,o,a,l,s){function c(e,t){e&&m.append(t)}function d(e){o(e,m.get())}function u(){v.removeEventListener(R,u,!1),f(v,n,i,0,n.size,c,a,d,l,s)}var v,m=new t;return e.zip.useWebWorkers?(v=new Worker(e.zip.workerScriptsPath+B),v.addEventListener(R,u,!1),v.postMessage({init:!0,level:r})):g(new e.zip.Deflater,n,i,0,n.size,c,a,d,l,s),v}function _(e,n,i,r,o,a,l,s,c){function d(){var t=u*T;r>t?e.readUint8Array(i+t,Math.min(T,r-t),function(e){o&&f.append(e),l&&l(t,r,e),n.writeUint8Array(e,function(){u++,d()},c)},s):a(r,f.get())}var u=0,f=new t;d()}function p(e){var t,n,i="",r=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++)n=255&e.charCodeAt(t),i+=n>127?r[n-128]:String.fromCharCode(n);return i}function h(e){return decodeURIComponent(escape(e))}function y(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function P(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(i){}}function b(e,t,n,i,r){return e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=P(e.lastModDateRaw),1===(1&e.bitFlag)?void r(x):((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295===e.compressedSize||4294967295===e.uncompressedSize?void r(O):(e.filenameLength=t.view.getUint16(n+22,!0),void(e.extraFieldLength=t.view.getUint16(n+24,!0))))}function w(e,t){function n(){}function r(n,o){e.readUint8Array(e.size-n,n,function(e){var t=i(e.length,e).view;1347093766!=t.getUint32(0)?r(n+1,o):o(t)},function(){t(C)})}return n.prototype.getData=function(n,r,o,a){function l(e,t){f&&f.terminate(),f=null,e&&e(t)}function s(e){var t=i(4);return t.view.setUint32(0,e),g.crc32==t.view.getUint32(0)}function c(e,t){a&&!s(t)?d():n.getData(function(e){l(r,e)})}function d(){l(t,S)}function u(){l(t,L)}var f,g=this;e.readUint8Array(g.offset,30,function(r){var l,s=i(r.length,r);return 1347093252!=s.view.getUint32(0)?void t(E):(b(g,s,4,!1,t),l=g.offset+30+g.filenameLength+g.extraFieldLength,void n.init(function(){0===g.compressionMethod?_(e,n,l,g.compressedSize,a,c,o,d,u):f=v(e,n,l,g.compressedSize,a,c,o,d,u)},u))},d)},{getEntries:function(o){return e.size<22?void t(E):void r(22,function(r){var a,l;a=r.getUint32(16,!0),l=r.getUint16(8,!0),e.readUint8Array(a,e.size-a,function(e){var r,a,s,c,d=0,u=[],f=i(e.length,e);for(r=0;l>r;r++){if(a=new n,1347092738!=f.view.getUint32(d))return void t(E);b(a,f,d+6,!0,t),a.commentLength=f.view.getUint16(d+32,!0),a.directory=16==(16&f.view.getUint8(d+38)),a.offset=f.view.getUint32(d+42,!0),s=y(f.array.subarray(d+46,d+46+a.filenameLength)),a.filename=2048===(2048&a.bitFlag)?h(s):p(s),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),c=y(f.array.subarray(d+46+a.filenameLength+a.extraFieldLength,d+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048===(2048&a.bitFlag)?h(c):p(c),u.push(a),d+=46+a.filenameLength+a.extraFieldLength+a.commentLength}o(u)},function(){t(C)})})},close:function(e){e&&e()}}}function A(e){return unescape(encodeURIComponent(e))}function k(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function I(e,t,n){function r(e,t){l&&l.terminate(),l=null,e&&e(t)}function o(){r(t,D)}function a(){r(t,S)}var l,s={},c=[],d=0;return{add:function(u,f,g,v,p){function h(t){var r;I=p.lastModDate||new Date,b=i(26),s[u]={headerArray:b.array,directory:p.directory,filename:w,offset:d,comment:k(A(p.comment||""))},b.view.setUint32(0,335546376),p.version&&b.view.setUint8(0,p.version),n||0===p.level||p.directory||b.view.setUint16(4,2048),b.view.setUint16(6,(I.getHours()<<6|I.getMinutes())<<5|I.getSeconds()/2,!0),b.view.setUint16(8,(I.getFullYear()-1980<<4|I.getMonth()+1)<<5|I.getDate(),!0),b.view.setUint16(22,w.length,!0),r=i(30+w.length),r.view.setUint32(0,1347093252),r.array.set(b.array,4),r.array.set(w,30),d+=r.array.length,e.writeUint8Array(r.array,t,o)}function y(t,n){var a=i(16);d+=t||0,a.view.setUint32(0,1347094280),"undefined"!=typeof n&&(b.view.setUint32(10,n,!0),a.view.setUint32(4,n,!0)),f&&(a.view.setUint32(8,t,!0),b.view.setUint32(14,t,!0),a.view.setUint32(12,f.size,!0),b.view.setUint32(18,f.size,!0)),e.writeUint8Array(a.array,function(){d+=16,r(g)},o)}function P(){return p=p||{},u=u.trim(),p.directory&&"/"!=u.charAt(u.length-1)&&(u+="/"),s.hasOwnProperty(u)?void t(N):(w=k(A(u)),c.push(u),void h(function(){f?n||0===p.level?_(f,e,0,f.size,!0,y,v,a,o):l=m(f,e,p.level,y,v,a,o):y()},o))}var b,w,I;f?f.init(P,a):P()},close:function(t){var n,a,l,u=0,f=0;for(a=0;a<c.length;a++)l=s[c[a]],u+=46+l.filename.length+l.comment.length;for(n=i(u+22),a=0;a<c.length;a++)l=s[c[a]],n.view.setUint32(f,1347092738),n.view.setUint16(f+4,5120),n.array.set(l.headerArray,f+6),n.view.setUint16(f+32,l.comment.length,!0),l.directory&&n.view.setUint8(f+38,16),n.view.setUint32(f+42,l.offset,!0),n.array.set(l.filename,f+46),n.array.set(l.comment,f+46+l.filename.length),f+=46+l.filename.length+l.comment.length;n.view.setUint32(f,1347093766),n.view.setUint16(f+8,c.length,!0),n.view.setUint16(f+10,c.length,!0),n.view.setUint32(f+12,u,!0),n.view.setUint32(f+16,d,!0),e.writeUint8Array(n.array,function(){r(function(){e.getData(t)})},o)}}}var F,E="File format is not recognized.",x="File contains encrypted entry.",O="File is using Zip64 (4gb+ file size).",C="Error while reading zip file.",D="Error while writing zip file.",L="Error while writing file data.",S="Error while reading file data.",N="File already exists.",T=524288,M="js/inflate.js",B="js/deflate.js",U="text/plain",R="message";try{F=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(j){}t.prototype.table=function(){var e,t,n,i=[];for(e=0;256>e;e++){for(n=e,t=0;8>t;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),o.prototype=new r,o.prototype.constructor=o,a.prototype=new r,a.prototype.constructor=a,l.prototype=new r,l.prototype.constructor=l,s.prototype.getData=function(e){e(this.data)},c.prototype=new s,c.prototype.constructor=c,d.prototype=new s,d.prototype.constructor=d,u.prototype=new s,u.prototype.constructor=u,e.zip={Reader:r,Writer:s,BlobReader:l,Data64URIReader:a,TextReader:o,BlobWriter:u,Data64URIWriter:d,TextWriter:c,createReader:function(e,t,n){e.init(function(){t(w(e,n))},n)},createWriter:function(e,t,n,i){e.init(function(){t(I(e,n,i))},n)},workerScriptsPath:"",useWebWorkers:!0}}(this);var saveAs=saveAs||navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=e.URL||e.webkitURL||e,r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o=!e.externalHost&&"download"in r,a=function(n){var i=t.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)},l=e.webkitRequestFileSystem,s=e.requestFileSystem||l||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},d="application/octet-stream",u=0,f=[],g=function(){for(var e=f.length;e--;){var t=f[e];"string"==typeof t?i.revokeObjectURL(t):t.remove()}f.length=0},v=function(e,t,n){t=[].concat(t);for(var i=t.length;i--;){var r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,n||e)}catch(o){c(o)}}},m=function(t,i){var c,g,m,_=this,p=t.type,h=!1,y=function(){var e=n().createObjectURL(t);return f.push(e),e},P=function(){v(_,"writestart progress write writeend".split(" "))},b=function(){(h||!c)&&(c=y(t)),g?g.location.href=c:window.open(c,"_blank"),_.readyState=_.DONE,P()},w=function(e){return function(){return _.readyState!==_.DONE?e.apply(this,arguments):void 0}},A={create:!0,exclusive:!1};return _.readyState=_.INIT,i||(i="download"),o?(c=y(t),r.href=c,r.download=i,a(r),_.readyState=_.DONE,void P()):(e.chrome&&p&&p!==d&&(m=t.slice||t.webkitSlice,t=m.call(t,0,t.size,d),h=!0),l&&"download"!==i&&(i+=".download"),(p===d||l)&&(g=e),s?(u+=t.size,void s(e.TEMPORARY,u,w(function(e){e.root.getDirectory("saved",A,w(function(e){var n=function(){e.getFile(i,A,w(function(e){e.createWriter(w(function(n){n.onwriteend=function(t){g.location.href=e.toURL(),f.push(e),_.readyState=_.DONE,v(_,"writeend",t)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&b()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=_["on"+e]}),n.write(t),_.abort=function(){n.abort(),_.readyState=_.DONE},_.readyState=_.WRITING}),b)}),b)};e.getFile(i,{create:!1},w(function(e){e.remove(),n()}),w(function(e){e.code===e.NOT_FOUND_ERR?n():b()}))}),b)}),b)):void b())},_=m.prototype,p=function(e,t){return new m(e,t)};return _.abort=function(){var e=this;e.readyState=e.DONE,v(e,"abort")},_.readyState=_.INIT=0,_.WRITING=1,_.DONE=2,_.error=_.onwritestart=_.onprogress=_.onwrite=_.onabort=_.onerror=_.onwriteend=null,e.addEventListener("unload",g,!1),p}(self);"undefined"!=typeof module&&(module.exports=saveAs);var strings=function(){var e={};return e.getFileTypeFromFilename=function(t){var n=t.lastIndexOf("."),i=t.slice(n+1,t.length).toLowerCase();return i=e.removeAllCharactersFromStringExcept(i,"abcdefghijklmnopqrstuvwxyz0123456789")},e.getFilenameFromFilePath=function(t){return-1!=t.indexOf("\\")?e.getFilenameFromWindowsFilePath(t):e.getFilenameFromUNIXFilePath(t)},e.getFilenameFromUNIXFilePath=function(e){var t=e.lastIndexOf("/");return-1==t?e:e.substring(t+1)},e.getFilenameFromWindowsFilePath=function(e){var t=e.lastIndexOf("\\");return-1==t?e:e.substring(t+1)},e.getDirectoryFromFilePath=function(t){return-1!=t.indexOf("\\")?e.getDirectoryFromWindowsFilePath(t):e.getDirectoryFromUNIXFilePath(t)},e.getDirectoryFromUNIXFilePath=function(e){var t=e.lastIndexOf("/");return-1==t?void 0:e.substring(0,t+1)},e.getDirectoryFromWindowsFilePath=function(e){var t=e.lastIndexOf("\\");return-1==t?void 0:e.substring(0,t+1)},e.linesToArray=function(t){for(var n=t.split("\n"),i=0;i<n.length;i++)n[i]=e.removeCharactersFromString(n[i],"\r");return n},e.randomString=function(e,t){for(var n="",i=e;i>0;--i)n+=t[Math.round(Math.random()*(t.length-1))];return n},e.replaceAccentBearingLettersWithASCISubstitute=function(e){var t=e;return"string"!=typeof t&&console.error("replaceAccentBearingLetters: Argument is not of type 'string'"),t=t.replace(/á/g,"a").replace(/à/g,"a").replace(/Á/g,"A").replace(/À/g,"A").replace(/ä/g,"ae").replace(/Ä/g,"Ae"),t=t.replace(/Ç/g,"C").replace(/Ĉ/g,"C").replace(/ĉ/g,"c").replace(/ć/g,"c").replace(/č/g,"c").replace(/Ć/g,"C").replace(/Č/g,"C").replace(/ï/g,"c").replace(/Ï/g,"C").replace(/ċ/g,"c").replace(/Ċ/g,"C"),t=t.replace(/é/g,"e").replace(/è/g,"e").replace(/É/g,"E").replace(/È/g,"E").replace(/Ê/g,"E").replace(/ê/g,"e"),t=t.replace(/î/g,"i").replace(/Î/g,"I").replace(/í/g,"i").replace(/ì/g,"i").replace(/Í/g,"I").replace(/Ì/g,"I").replace(/ï/g,"i").replace(/Ï/g,"I"),t=t.replace(/ö/g,"oe").replace(/Ö/g,"Oe").replace(/ó/g,"o").replace(/ò/g,"o").replace(/Ó/g,"O").replace(/Ò/g,"O").replace(/Ô/g,"O").replace(/ô/g,"o").replace(/õ/g,"o"),t.replace(/Ü/g,"Ue").replace(/ü/g,"ue").replace(/Û/g,"U").replace(/û/g,"u"),t.replace(/ÿ/g,"y").replace(/Ý/g,"Y"),t=t.replace(/ß/g,"ss").replace(/\s+/g,"_")},e.removeCharactersFromString=function(e,t){for(var n,i,r=0;r<t.length;r++)for(n=t[r];-1!=e.indexOf(n);)i=e.indexOf(n),e=e.slice(0,i)+e.slice(i+1,e.length);return e},e.removeAllCharactersFromStringExcept=function(e,t){for(var n,i,r=0;r<e.length;)n=e[r],-1==t.indexOf(n)?(i=e.indexOf(n),e=e.slice(0,i)+e.slice(i+1,e.length)):r++;return e},e.replaceCharactersInStringWithSubstitute=function(e,t,n){for(var i,r=0;r<t.length;r++){i=t[r];for(var o=0;o<e.length;)e[o]!=i?o+=1:(e=e.slice(0,o)+n+e.slice(o+1),o+=n.length)}return e},e.isSubstringAStartOfAWordInString=function(e,t){switch(e=e.toLowerCase(),t=t.toLowerCase(),e.indexOf(t)){case-1:return!1;case 0:return!0;default:var n=e[e.indexOf(t)-1];return-1!=",. ".indexOf(n)?!0:!1}},e.removeEndingFromFilename=function(e){var t=e.lastIndexOf(".");return e.slice(0,t)},e.bytesToSize=function(e,t){var n=1024,i=1024*n,r=1024*i,o=1024*r;return e>=0&&n>e?e+" B":e>=n&&i>e?(e/n).toFixed(t)+" KB":e>=i&&r>e?(e/i).toFixed(t)+" MB":e>=r&&o>e?(e/r).toFixed(t)+" GB":e>=o?(e/o).toFixed(t)+" TB":e+" B"},e.areOnlyTheseCharsInString=function(e,t){for(var n=0;n<e.length;n++)if(-1==t.indexOf(e[n]))return!1;return!0},e}(),XMLString=function(){"use strict";var e,t="",n=function(t,n,r){t=o.escapeOrRemoveIllegalCharacters(t);var a="<";if("close"==n&&(a+="/"),a+=e&&""!==e?e+":"+t:t,"open"===n||"self-closing"==n){var l=t.length;e&&""!==e&&(l=l+e.length+1),a+=i(r,l)}return"self-closing"==n&&(a+="/"),a+=">"},i=function(e,t){for(var n="",i=0;i<e.length;i++){if(0!==i){n+="\n",n+=r(o.tab);for(var a=0;t>a;a++)n+=" ";n+="  "}0===i&&(n+=" "),n+=o.escapeOrRemoveIllegalCharacters(e[i][0]),n+="=",n+='"',n+=o.escapeOrRemoveIllegalCharacters(e[i][1]),n+='"'}return n},r=function(e){for(var t="",n=0;e>n;n++)for(var i=0;i<o.spaces_per_tab;i++)t+=" ";return t},o=this;o.header=function(){t+='<?xml version="1.0" encoding="UTF-8"?>\n'},o.last_mode=null,o.tab=0,o.spaces_per_tab=3,o.reset=function(){o.last_mode=null,t="",o.tab=0,e=void 0},o.escapeOrRemoveIllegalCharacters=function(e){for(var t,n,i=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&apos;","'"],["&quot;",'"']],r=0;r<i.length;r++)t=i[r][1],n=i[r][0],e=strings.replaceCharactersInStringWithSubstitute(e,t,n);return e=e.replace("/[^\\x{0009}\\x{000a}\\x{000d}\\x{0020}-\\x{D7FF}\\x{E000}-\\x{FFFD}]+/u","")},o.setElementPrefix=function(t){e="string"==typeof t&&""!==t?t:void 0},o.tag=function(e,i,a){if("string"!=typeof e)return void console.error("XML.Element: typeof Element name = "+typeof e+". Must be string!");a||(a=[]);var l="";return"close"==i&&(o.tab-=1),"close"==i&&"open"==o.last_mode||null===o.last_mode||(l+="\n",l+=r(o.tab)),l+=n(e,i,a),"open"===i&&(o.tab+=1),o.last_mode=i,t+=l,l},o.insertValue=function(e){return e=o.escapeOrRemoveIllegalCharacters(e),t+=e,e},o.element=function(e,t,n){var i="";return"undefined"==typeof t&&(t="undefined",console.warn("XML.Element: Value of "+e+" is undefined!")),"number"==typeof t&&(t=t.toString()),""!==t?(i+=o.open(e,n),i+=o.insertValue(t),i+=o.close(e)):i+=o.tag(e,"self-closing",n),i},o.open=function(e,t){return o.tag(e,"open",t)},o.close=function(e){return o.tag(e,"close")},o.selfClosing=function(e,t){return o.tag(e,"self-closing",t)},o.getString=function(){var e=t;
return o.reset(),e}},dom=function(){var e={};return e.getSelectedRadioIndex=function(e){"string"==typeof e&&(e=document.getElementsByName(e));for(var t=0;t<e.length;t++)if(e[t].checked===!0)return t;return 0},e.getSelectedRadioValue=function(t){return"string"==typeof t&&(t=document.getElementsByName(t)),t[e.getSelectedRadioIndex(t)].value},e.makeRadios=function(t,n,i,r,o,a,l,s,c){for(var d,u=[],f=0;f<n.length;f++){if(c)var g=c[f];else g=void 0;d=e.makeRadio(t,n[f][a],n[f][o],r+f,i,s,g),(f===l||l==n[f][a])&&(d.checked=!0),e.br(t),u.push(d)}return u},e.makeRadio=function(t,n,i,r,o,a,l){var s=e.input(t,r,"",o,"radio",n);l&&(s.title=l);var c=e.span(t,"",""," "+i);return l&&(c.title=l),c.addEventListener("click",function(e){return function(){e.checked=!0}}(s),!1),a&&(s.addEventListener("click",function(e){e.stopPropagation(),a(n)},!1),c.addEventListener("click",function(e){e.stopPropagation(),a(n)},!1)),s},e.removeOptions=function(e){var t;for(t=e.options.length-1;t>=0;t--)e.remove(t)},e.setRadiosByValue=function(e,t){for(var n=0;n<e.length;n++)if(e[n].value==t)return void(e[n].checked=!0);console.error("dom.setRadioByValue: Value "+t+" not available in radios!")},e.setRadioIndex=function(e,t){return"number"!=typeof t?void console.error("dom.setRadioIndex: index is not of type number but "+typeof t):void(e[t].checked=!0)},e.getOptionValuesOfSelect=function(e){var t=[];return forEach(e.options,function(e){t.push(e.value)}),t},e.br=function(t){var n=e.newElement("br","","",t);return n},e.img=function(t,n,i,r){var o=e.newElement("img",n,i,t);return o.src=r,o},e.div=function(t,n,i,r){var o=e.newElement("div",n,i,t,r);return o},e.span=function(t,n,i,r){var o=e.newElement("span",n,i,t,r);return o},e.spanBR=function(t,n,i,r){var o=e.span(t,n,i,r);return e.br(t),o},e.p=function(t,n,i,r){var o=e.newElement("p",i,r,t,n);return o},e.a=function(t,n,i,r,o,a){var l=e.newElement("a",n,i,t,o);return r&&(l.href=r),"undefined"!=typeof a&&l.addEventListener("click",a),l},e.link=function(t,n,i,r,o){var a=e.a(t,n,i,void 0,r,o);return a},e.h1=function(t,n){var i=e.newElement("h1","","",t,n);return i},e.h2=function(t,n){var i=e.newElement("h2","","",t,n);return i},e.h3=function(t,n){var i=e.newElement("h3","","",t,n);return i},e.h5=function(t,n){var i=e.newElement("h5","","",t,n);return i},e.input=function(t,n,i,r,o,a){var l=e.newElement("input",n,i,t);return l.type=o,l.name=r,"undefined"!=typeof a&&(l.value=a),l},e.checkbox=function(t,n,i,r,o){var a=e.input(t,n,i,r,"checkbox");return a.checked=o,a},e.textInput=function(t,n,i,r,o){return e.input(t,n,i,r,"text",o)},e.button=function(t,n,i){var r=e.input(t,"","","","button",n);return r.addEventListener("click",i,!1),r},e.textarea=function(t,n,i,r,o,a){var l=e.make("textarea",n,i,t);return l.rows=r,l.cols=o,l.value=a,l},e.newElement=function(e,t,n,i,r){var o=document.createElement(e);return""!==t&&(o.id=t),""!==n&&(o.className=n),"undefined"!=typeof i&&i.appendChild(o),r&&(o.innerHTML=r),o},e.make=e.newElement,e.remove=function(e){if("string"==typeof e){var t=e;e=g(t)}return"undefined"==typeof e?void console.error("dom.remove: Element undefined. id = "+t):e.parentNode.removeChild(e)},e.hideAllChildren=function(t){var n=t.children;forEach(n,e.hideElement)},e.showAllChildren=function(e){for(var t=e.children,n=0;n<t.length;n++)t[n].style.display=""},e.hideElement=function(e){e.style.display="none"},e.hide=e.hideElement,e.unhideElement=function(e){e.style.display=""},e.scrollTop=function(e){e.scrollTop=0},e.setSelectOptions=function(t,n,i,r,o){var a;if(e.removeOptions(t),o===!0){var l=new Option("",0,!1,!0);t.options[t.options.length]=l}forEach(n,function(n,o){var l;a="undefined"!=typeof i?n[i]:n,"take_index"==i&&(a=o),l="undefined"!=typeof r?n[r]:n,"take_index"==r&&(l=o),e.appendOption(t,a,l)}),t.selectedIndex=0},e.appendOption=function(e,t,n){var i=new Option(t,n,!1,!0);e.options[e.options.length]=i},e.appendHTMLContent=function(t,n){if("string"==typeof n){var i=e.span(t,"","","");i.innerHTML+=n}"object"==typeof n&&"[object Array]"!==Object.prototype.toString.call(n)&&t.appendChild(n),"[object Array]"===Object.prototype.toString.call(n)&&forEach(n,function(n){e.appendHTMLContent(t,n)})},e.getByName=function(e){return document.getElementsByName(e)},e}(),ObjectList=function(e){"use strict";var t=this,n=[],i=0,r=-1,o=function(){var e=i;return i+=1,e},a=function(e){var t={};Array.isArray(e)&&(t=[]);for(var n in e)t[n]=e[n]&&"object"==typeof e[n]?a(e[n]):e[n];return t},l=function(){!t.IDexists(r)&&t.length>0&&(r=t.IDof(0)),0===t.length&&(r=-1)};if(this.length=0,this.IDexists=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return!0;return!1},this.existsByID=this.IDexists,this.getByIndex=function(e){return n[e]},this.getByID=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return n[t];return void 0},this.get=this.getByIndex,this.getFirst=function(){return n.length>0?n[0]:void 0},this.getLast=function(){return n.length>0?n[n.length-1]:void 0},this.getFromEnd=function(e){return e<n.length?n[n.length-1-e]:void 0},this.getAll=function(){return n},this.getByKeyValue=function(e,t){for(var i=0;i<n.length;i++)if(n[i][e]==t)return n[i];return void 0},this.getIndexByID=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return t;return void 0},this.indexOf=this.getIndexByID,this.getArrayWithValuesByKey=function(e){var t=map(n,function(t){return t[e]});return t},this.getArrayWithIDs=function(){return t.getArrayWithValuesByKey("id")},this.idOf=function(e){return n[e].id},this.IDof=this.idOf,this.removeByID=function(e){if(Array.isArray(e)===!0)return void forEach(e,t.removeByID);var i=t.getIndexByID(e);n.splice(i,1),t.length=n.length,l()},this.eraseByID=this.removeByID,this.removeByIndex=function(e){n.splice(e,1),t.length=n.length,l()},this.remove=this.removeByIndex,this.erase=this.removeByIndex,this.removeFirst=function(){t.removeByIndex(0)},this.removeLast=function(){n.length>0&&t.removeByID(n[n.length-1].id)},this.removeAll=function(){n=[],t.length=n.length,r=-1},this.removeActive=function(){t.removeByID(r)},this.eraseAll=this.removeAll,this.add=function(e){var i=o();return e.id=i,n.push(e),t.length=n.length,l(),i},this.replaceByID=function(e,i){var r=t.getIndexByID(e);"undefined"!=typeof r&&(i.id=e,n.splice(r,1,i))},this.replace=this.replaceByID,this.replaceActive=function(e){t.replaceByID(r,e)},this.duplicateByID=function(e){var n=a(t.getByID(e));t.add(n)},this.duplicate=this.duplicateByID,this.duplicateByIndex=function(e){var n=a(t.getByIndex(e));t.add(n)},this.duplicateActive=function(){t.duplicateByID(r)},this.forEach=function(e){for(var t=0;t<n.length;t++)e(n[t],t)},this.map=function(e){for(var t=[],i=0;i<n.length;i++)t.push(e(n[i]));return t},this.filter=function(e){for(var t=[],i=0;i<n.length;i++)e(n[i])&&t.push(n[i]);return t},this.reset=function(){n=[],i=0,r=-1,t.length=n.length},this.setState=function(e,o){if(!e||!e.list||"object"!=typeof e.list){if(o&&Array.isArray(e)){t.reset();for(var a=0;a<e.length;a++)t.add(e[a]);return}return void console.error("Error setState: Invalid data! typeof state.list = "+typeof e.list+", typeof state = "+typeof e)}i=e.id_counter,n=e.list,t.length=n.length,r=e.pointer},this.getState=function(){var e={id_counter:i,list:n,pointer:r,info:"ObjectList state"};return e},this.sortByKey=function(e){return n.sort(function(t,n){var i=t[e],r=n[e];return"string"==typeof i&&(i=i.toLowerCase(),r=r.toLowerCase()),r>i?-1:i>r?1:0})},this.sortBySubKey=function(e,t){return n.sort(function(n,i){var r=n[e][t],o=i[e][t];return"string"==typeof r&&(r=r.toLowerCase(),o=o.toLowerCase()),o>r?-1:r>o?1:0})},this.isThereAnyItemWhereKeyIsValue=function(e,i){for(var r=0;r<n.length;r++)if(t.get(r)[e]==i)return!0;return!1},this.isThereAnyItemWhereKeyIsNotValue=function(e,i){for(var r=0;r<n.length;r++)if(t.get(r)[e]!=i)return!0;return!1},this.isKeyValueInEveryItem=function(e,n){return!t.isThereAnyItemWhereKeyIsNotValue(e,n)},this.isThereAnyItemWhereSubKeyIsValue=function(e,i,r){for(var o=0;o<n.length;o++)if(t.get(o)[e][i]==r)return!0;return!1},this.isThereAnyItemWhereSubKeyIsNotValue=function(e,i,r){for(var o=0;o<n.length;o++)if(t.get(o)[e][i]!=r)return!0;return!1},this.setPointer=function(e){t.IDexists(e)&&(r=e)},this.setPointerByIndex=function(e){n[e]&&t.setPointer(n[e].id)},this.getPointer=function(){return r},this.getIndexOfActiveObject=function(){return t.getIndexByID(r)},this.getActiveIndex=this.getIndexOfActiveObject,this.getActiveObject=function(){return t.getByID(r)},this.getActive=this.getActiveObject,this.activeItemExists=function(){return-1!=r?!0:!1},this.mapIndexesToIDs=function(e){var t=e.map(function(e){return n[e].id});return t},this.setForAll=function(e,t){n.forEach(function(n){n[e]=t})},Array.isArray(e))for(var s=0;s<e.length;s++)t.add(e[s])},APP=function(){"use strict";var e=function(){var e=(g("VIEW_start"),Math.floor(Math.random()*APP.CONF.hellos.length));g("hello").innerHTML=APP.CONF.hellos[e][0],g("hello").addEventListener("click",function(){n.log(n.l("start","this_is","before_language")+APP.CONF.hellos[e][1]+n.l("start","this_is","after_language"))}),g("greeting_text").innerHTML=n.l("start","greeting_text"),g("start_select_profile_span").innerHTML=n.l("start","select_your_profile"),g("before_lets_go").innerHTML=n.l("start","and_lets_go__before_link"),g("link_lets_go").innerHTML=n.l("start","and_lets_go__link"),g("after_lets_go").innerHTML=n.l("start","and_lets_go__after_link"),g("supported_by_label").innerHTML=n.l("start","is_supported_by"),g("need_help_label").innerHTML=n.l("start","need_help"),g("help_pages_description").innerHTML=n.l("start","help_pages_description");var t=g("lang_links");forEach(n.languages,function(e,n){dom.link(t,"","",e.code.toUpperCase(),function(){APP.changeLanguage(n)}),dom.span(t,"","","  ")}),g("link_lets_go").addEventListener("click",function(){"undefined"==typeof n.environments.active_environment&&n.environments.load(n.environments.get(0)),n.environments.active_environment.workflow[0]?n.view(n.environments.active_environment.workflow[0]):console.error("ERROR: The active profile does not have a workflow!")})},t=function(){var e=g("language_select");dom.setSelectOptions(e,n.languages,"name","id",!1)},n={};n.init=function(i){var r;n.active_language=n.getActiveLanguageByNavigatorLanguageOrTakeDefault(),i||(r=n.save_and_recall.getRecallDataForApp(),r&&r.settings.active_language_id&&(n.active_language=n.getLPFromID(r.settings.active_language_id)),r&&r.version&&r.version!=APP.CONF.version&&(console.info("APP version is different than recall object version. APP version = "+APP.CONF.version+" , Recall Object version = "+r.version),n.log(n.l("start","you_are_now_using_version__before_version_number")+APP.CONF.version+n.l("start","you_are_now_using_version__after_version_number")))),e(),n.checkIfFirstStart(),g("version_span").innerHTML="v"+APP.CONF.version,g("settings_heading").innerHTML=n.l("settings","settings"),n.settings.init(n.coreSettings(),g("core_settings")),t(),g("VIEWLINK_start").addEventListener("click",function(){n.view("VIEW_start")}),document.addEventListener("keydown",function(e){27==e.keyCode&&APP.GUI.closeSelectFrame()}),n.environments.displayAllInSelect(),i||"undefined"==typeof r||n.recall(r),n.GUI.mainMenu.draw(n.main_menu_elements()),window.addEventListener("beforeunload",n.save,!1),addScript(APP.CONF.path_to_scripts+APP.CONF.languageIndex_filename,function(){console.log("LanguageIndex ready!")},!0),console.log("Welcome to CMDI Maker v"+APP.CONF.version)},n.getActiveLanguageByNavigatorLanguageOrTakeDefault=function(){var e=navigator.language,t=e.indexOf("-");-1!=t&&(e=e.substring(0,t));var i=getObject(n.languages,"code",e);return"undefined"!=typeof i?i:n.languages[0]},n.languages=[],n.getLPFromID=function(e){var t=getObject(n.languages,"id",e);return"undefined"==typeof t&&console.error("ERROR: No language object with id "+e+" found!"),t},n.getIndexFromLPID=function(e){var t=getIndex(n.languages,"id",e);return"undefined"==typeof t&&console.error("ERROR: No language object with id "+e+" found!"),t},n.active_view=void 0,n.active_language=void 0,n.views=[{id:"start",place:"top"},{id:"settings",icon:"wrench"},{id:"about",icon:"about"}],n.l=function(e,t,i,r){return n.getTermInActiveLanguage(n.languages,e,t,i,r)},n.getActiveLanguagePackFromID=function(e,t){return getObject(t,"id",e)};var i=function(e,t,n,i,r){return e?"undefined"==typeof e[t]?void 0:r?"undefined"!=typeof e[t][n][i][r]?e[t][n][i][r]:void 0:i?"undefined"!=typeof e[t]&&"undefined"!=typeof e[t][n][i]?e[t][n][i]:void 0:n?"undefined"!=typeof e[t]&&"undefined"!=typeof e[t][n]?e[t][n]:void 0:e[t]:void 0};return n.getTermInActiveLanguage=function(e,t,r,o,a){var l=n.getActiveLanguagePackFromID(n.active_language.id,e),s=i(l,t,r,o,a);if("undefined"!=typeof s)return s;console.warn("Haven't found a term in "+n.active_language.name+": "+t+(r?", "+r:"")+(o?", "+o:"")+(a?", "+a:"")+". Trying to get it in default language.");var c=e[0],d=i(c,t,r,o,a);return"undefined"!=typeof d?d:(console.error("LANGUAGE ERROR: "+t+(r?", "+r:"")+(o?", "+o:"")+(a?", "+a:"")),APP.CONF.language_error_placeholder)},n.main_menu_elements=function(){return[{title:n.l("open_file"),id:"LINK_open_file",icon:"open",onclick:function(){n.GUI.showFileDialog(APP.save_and_recall.loadFromFile)}},{title:n.l("export_to_file"),id:"LINK_export_to_file",icon:"save",onclick:function(){n.save_and_recall.saveActiveEnvironmentStateToFile()}},{title:n.l("reset_form"),icon:"reset",id:"LINK_reset_form",onclick:function(){APP.confirm(n.l("really_reset_form"),function(e){e||(APP.environments.resetActive(),APP.log(n.l("form_reset")))},n.l("no"),n.l("yes_delete_form"))}},{title:n.l("settings","settings"),id:"VIEWLINK_settings",icon:"wrench",onclick:function(){APP.view("VIEW_settings")}},{title:n.l("about"),id:"VIEWLINK_about",icon:"about",onclick:function(){APP.view("VIEW_about")}}]},n.coreSettings=function(){return[{title:n.l("settings","program_language"),type:"select",name:"language_select",id:"language_select",onchange:function(){n.changeLanguage(g("language_select").selectedIndex)}},{title:n.l("settings","profile"),type:"select",name:"profile_select",id:"profile_select",onchange:function(){n.environments.change(g("profile_select").selectedIndex-1)}},{title:n.l("settings","auto_save"),radio_name:"radio_auto_save",type:"radio",options:[{title:n.l("settings","off"),value:-1},{title:n.l("settings","every_30_seconds"),value:30},{title:n.l("settings","every_60_seconds"),value:60},{title:n.l("settings","every_5_minutes"),value:300},{title:n.l("settings","every_10_minutes"),value:600}],default_option:2,onchange:n.save_and_recall.setAutosaveInterval},{title:n.l("settings","delete_recall_data"),type:"link",description:n.l("settings","delete_recall_data_description"),onclick:function(){n.save_and_recall.deleteEnvironmentData()}},{title:n.l("settings","hard_reset"),importance:"high",type:"link",description:n.l("settings","hard_reset_description"),onclick:function(){APP.confirm(n.l("confirm","hard_reset"),function(e){e||n.hard_reset()},n.l("confirm","no"),n.l("confirm","yes_delete_everything"))}}]},n.checkIfFirstStart=function(){var e=localStorage.getItem("first_start");null===e&&(e=!0),e===!0?(localStorage.setItem("first_start",!1),console.log("First start! Hey there and welcome to CMDI Maker!")):n.log(n.l("welcome_back"))},n.log=function(e,t){t||(t=""),alertify.log(e,t,APP.CONF.log_message_period)},n.confirm=function(e,t,n,i){alertify.set({labels:{ok:n,cancel:i}}),alertify.confirm(e,t)},n.alert=function(e){alertify.set({labels:{ok:n.l("ok")}}),alertify.alert(e)},n.hard_reset=function(){n.save_and_recall.deleteAllData(),window.removeEventListener("beforeunload",n.save),location.reload()},n.view=function(e){var t,i;if(n.GUI.closeSelectFrame(),n.GUI.mainMenu.close(),"undefined"==typeof e&&(console.warn("APP.view: module_or_id is undefined. Showing default view!"),e="default"),"string"==typeof e)i=e,t=n.environments.getModuleByViewID(i);else{if(!e.identity)return console.warn("APP.view: module to view is undefined!"),void APP.view("default");t=e,i=APP.CONF.view_id_prefix+t.identity.id}"default"==i&&(i="VIEW_start");var r=g(APP.CONF.content_wrapper_id).children;forEach(r,dom.hide);var o=getArrayWithIDs(r);return-1==o.indexOf(i)?(console.warn("Warning: Unkown view requested ("+i+")!"),void n.view("default")):(n.active_view=i,n.GUI.highlightViewIcon(i),g("module_icons").style.display="block",n.GUI.showFunctionsForView(t),g(i).style.display="block",g("pager")&&dom.remove("pager"),void(t&&t.view&&t.view()))},n.save=function(){n.save_and_recall.save()},n.saveTextfile=function(e,t,n){var i=strings.replaceAccentBearingLettersWithASCISubstitute(t);n||(n=APP.CONF.file_download_header);var r=new Blob([e],{type:n});saveAs(r,i)},n.zipAllOutputFiles=function(){var e,t=document.getElementsByClassName(APP.CONF.xml_textarea_class_name);e="function"==typeof APP.environments.active_environment.getProjectName&&""!==APP.environments.active_environment.getProjectName()?APP.environments.active_environment.getProjectName()+".zip":APP.CONF.zip_archive_file_name,zip.createWriter(new zip.BlobWriter,function(n){var i=function(e){var t=-1,n=function(){return t++,t==e.length?void e.callback():void e.functionToLoop(n,t)};n()};i({length:t.length,functionToLoop:function(e,i){n.add(t[i].filename,new zip.TextReader(t[i].value),e)},callback:function(){n.close(function(t){console.log("GOT ZIP BLOB"),saveAs(t,e)})}})},function(){})},n.saveAllOutputFiles=function(){var e=document.getElementsByClassName(APP.CONF.xml_textarea_class_name);forEach(e,function(e){n.saveTextfile(e.value,e.filename)})},n.recall=function(e,t){if(console.log("Filling the form with recalled data"),e.settings.active_language_id){var i=n.getIndexFromLPID(e.settings.active_language_id);n.active_language=n.getLPFromID(e.settings.active_language_id),g("language_select").selectedIndex=i}if(dom.setRadiosByValue(g("radio_auto_save"),e.settings.save_interval_time),n.save_and_recall.setAutosaveInterval(e.settings.save_interval_time),e.active_environment_id){var r=n.environments.getByID(e.active_environment_id);n.environments.load(r),"undefined"==typeof t&&(t=n.save_and_recall.getRecallDataForEnvironment(r)),"undefined"!=typeof t&&n.save_and_recall.recallEnvironmentData(t)}n.view(e.active_view),g(APP.CONF.content_wrapper_id).scrollTop=e.scroll_top},n.changeLanguage=function(e){n.active_language=n.languages[e],location.reload()},n.doStandardLanguageSearch=function(e,t){if(e.length<3)return void APP.alert(n.l("languages","specify_search_request_at_least_3_chars"));for(var i=[],r=0;r<LanguageIndex.length;r++)strings.isSubstringAStartOfAWordInString(LanguageIndex[r][3],e)&&i.push(LanguageIndex[r][0]);var o=LanguageIndex.filter(function(e){return-1!=i.indexOf(e[0])&&"L"==e[2]}),a=map(o,function(e){return e[0]+", "+e[1]+", "+e[3]}),l=n.l("languages","language_search")+": "+o.length+" "+(1==o.length?n.l("languages","result"):n.l("languages","results")),s="(ISO639-3 Code, Country ID, "+n.l("languages","language_name")+")";APP.GUI.showSelectFrame(o,a,t,l,s)},document.addEventListener("DOMContentLoaded",function(){n.init()},!1),window.addEventListener("load",function(){window.applicationCache.addEventListener("updateready",function(){window.applicationCache.status==window.applicationCache.UPDATEREADY?(window.applicationCache.swapCache(),window.location.reload()):console.log("Manifest file on server didn't change.")},!1)},!1),n}();APP.languages[0]={id:"english",name:"English",code:"en",settings:{settings:"Settings",profile:"Profile",auto_save:"Auto Save",off:"Off",every_30_seconds:"Every 30 seconds",every_60_seconds:"Every 60 seconds",every_5_minutes:"Every 5 minutes",every_10_minutes:"Every 10 minutes",load_project:"Load Project",load_project_description:"Loads a CMP file with CMDI Maker project data.",delete_recall_data:"Delete Recall Data",delete_recall_data_description:"CMDI Maker saves the data you input in a browser database. Your data is kept, even when you close the browser window.<br>However, if Auto Save is on, new data will be saved automatically.<br>This function only deletes the data from the active profile!",hard_reset:"Hard Reset",hard_reset_description:"Deletes all data that CMDI Maker has ever stored on your PC.",program_language:"Program Language",no_project_data_found_in_file:"No CMDI Maker data found in file!"},save_and_recall:{active_profile_data_deleted:"Recall data for active profile deleted",no_data_found:"No data for active profile found",form_saved:"Form saved",no_data_to_save_no_profile_loaded:"There is no data to save because no profile is loaded."},confirm:{no:"No",yes_delete_everything:"Yes, delete everything",yes_overwrite_data:"Yes, overwrite data",overwrite_data:"Really?<br>You want to overwrite all data?",hard_reset:"Really?<br>You want to hard reset CMDI Maker? All your actors and stuff will be deleted!"},on:"On",off:"Off",ok:"OK",welcome_back:"Welcome back!",about:"About",save:"Save",export_to_file:"Export Project to File",open_file:"Open Project File",abort:"Abort",reset_form:"Reset Form",form_reset:"Form reset",really_reset_form:"Do you really want to delete all form data?",yes_delete_form:"Yes, delete Form",no:"No",start:{greeting_text:"Welcome to CMDI Maker!<br>Please note, that this is an offline web application. You can use it without an internet connection.<br>When you load this page, you can pick up where you left off.",and_lets_go__before_link:"and ",and_lets_go__link:"get started",and_lets_go__after_link:"!",is_supported_by:"CMDI Maker is supported by",need_help:"Need help?",help_pages_description:"On the help pages you will find video tutorials in several languages, a mailing list, go-to persons and much more!",select_your_profile:"Select your profile",this_is:{before_language:"This is ",after_language:"!"},you_are_now_using_version__before_version_number:"You are now using ",you_are_now_using_version__after_version_number:" of CMDI Maker."},language_search:{or_type_in_iso_code:"or type in ISO code",search:"Search"},forms:{drag_and_drop_files_here:"Drag and drop files here",this_character_is_not_allowed_here:"This character is not allowed here."},languages:{set_global_languages_of_content:"Set Global Languages of Content",language_search:"Language Search",result:"result",results:"results",language_name:"Language Name",is_new_global:"is a new Global Content Language",iso_code:"ISO code",not_found_in_db:"not found in database",specify_search_request_at_least_3_chars:"Please specify your search request.\nType in at least 3 characters.",primary_language:"Primary Language",mother_tongue:"Mother Tongue",current_content_languages:"Current Content Languages",content_language_removed__before_lang:'Content Language "',content_language_removed__after_lang:'" removed'}},APP.languages[1]={id:"german",name:"Deutsch",code:"de",settings:{settings:"Einstellungen",profile:"Profil",auto_save:"Automatische Speicherung",off:"Aus",every_30_seconds:"Alle 30 Sekunden",every_60_seconds:"Alle 60 Sekunden",every_5_minutes:"Alle 5 Minuten",every_10_minutes:"Alle 10 Minuten",load_project:"Projekt laden",load_project_description:"Lädt eine CMP-Datei und importiert ihre Projektdaten.",delete_recall_data:"Daten für den Rückruf löschen",delete_recall_data_description:"CMDI Maker speichert alle Daten, die du eingibst, in einer Browserdatenbank. Deine Daten bleiben also erhalten, auch wenn Du das Browserfenster schließt.<br>Wenn die automatische Speicherung jedoch aktiviert ist, werden automatisch neue Daten gespeichert.<br>Diese Funktion löscht nur die Daten des zur Zeit ausgewählten Profils!",hard_reset:"Hard Reset",hard_reset_description:"Diese Funktion löscht alle Daten, die der CMDI Maker jemals auf deinem PC gespeichert hat.",program_language:"Programmsprache",no_project_data_found_in_file:"In der Datei wurden keine Daten für den CMDI Maker gefunden!"},save_and_recall:{active_profile_data_deleted:"Daten des aktiven Profils gelöscht",no_data_found:"Keine Daten für das aktive Profil gefunden!",form_saved:"Eingaben gespeichert",no_data_to_save_no_profile_loaded:"Es gibt keine Daten zum Speichern, da kein Profil geladen ist."},confirm:{no:"Nein",yes_delete_everything:"Ja, alles löschen",yes_overwrite_data:"Ja, Daten überschreiben",overwrite_data:"Willst du das wirklich?<br>Alle deine Daten werden überschrieben!",hard_reset:"Willst du das wirklich?<br>Alle deine Daten werden gelöscht!"},on:"Ein",off:"Aus",ok:"OK",welcome_back:"Willkommen zurück!",about:"Über",save:"Speichern",export_to_file:"Projekt in Datei exportieren",open_file:"Projektdatei öffnen",abort:"Abbrechen",reset_form:"Formular zurücksetzen",form_reset:"Formular zurückgesetzt",really_reset_form:"Möchtest Du wirklich alle Formulareingaben löschen?",yes_delete_form:"Ja, löschen",no:"Nein",start:{greeting_text:"Willkommen!<br>Dies ist eine Offline-Webanwendung. Du kannst sie fortan auch ohne Internetverbindung nutzen.<br>Wenn Du diese Seite lädst, kannst du genau dort weitermachen, wo du aufgehört hast.",and_lets_go__before_link:"und ",and_lets_go__link:"leg los",and_lets_go__after_link:"!",is_supported_by:"CMDI Maker wird unterstützt von",need_help:"Brauchst Du Hilfe?",help_pages_description:"Auf den Hilfe-Seiten findest Du Video-Tutorials in verschiedenen Sprachen, eine Mailing-Liste, Ansprechpartner und vieles mehr!",select_your_profile:"Wähle dein Profil",this_is:{before_language:"Das ist ",after_language:"!"},you_are_now_using_version__before_version_number:"Du benutzt nun ",you_are_now_using_version__after_version_number:" von CMDI Maker."},language_search:{or_type_in_iso_code:"oder gib den ISO-Code ein",search:"Suchen"},forms:{drag_and_drop_files_here:"Ziehe Dateien in dieses Feld",this_character_is_not_allowed_here:"Dieses Zeichen ist hier nicht erlaubt."},languages:{set_global_languages_of_content:"Globale Content Language hinzufügen",language_search:"Sprachsuche",result:"Ergebnis",results:"Ergebnisse",language_name:"Sprachname",is_new_global:"ist neue globale Content Language",iso_code:"ISO-Code",not_found_in_db:"wurde nicht gefunden",specify_search_request_at_least_3_chars:"Bitte sei etwas genauer.\nGib mindestens 3 Zeichen ins Suchfeld ein.",primary_language:"Primärsprache",mother_tongue:"Muttersprache",current_content_languages:"Derzeitige Content Languages",content_language_removed__before_lang:'Content Language "',content_language_removed__after_lang:'" entfernt'}},APP.languages[2]={id:"spanish",name:"Español",code:"es",settings:{settings:"Configuración",profile:"Perfíl",auto_save:"Guardar automáticamente",off:"Apagado",every_30_seconds:"Cada 30 segundos",every_60_seconds:"Cada 60 segundos",every_5_minutes:"Cada 5 minutos",every_10_minutes:"Cada 10 minutos",load_project:"Guardar proyecto",load_project_description:"Esta opción carga un archivo CMP (CMDI Maker Project) junto con los datos del proyecto.",delete_recall_data:"Eliminar datos guardados",delete_recall_data_description:"CMDI Maker guarda los datos que se introducen en la base de datos de un navegador, y los guardará aun cuando se cierre el navegador.<br>De todas formas, si la opción Guardar automáticamente está seleccionada, los nuevos datos serán guardados automáticamente.<br>¡Esta función elimina solamente los datos pertenecientes al perfil activo!",hard_reset:"Reseteo completo",hard_reset_description:"Esta opción elimina todos los datos que CMDI Maker ha almacenado en su ordenador.",program_language:"Lenguaje del programa",no_project_data_found_in_file:"¡No se encontró ningún dato para CMDI Maker en el archivo!"},save_and_recall:{active_profile_data_deleted:"Datos pertenecientes al perfíl activo eliminados",no_data_found:"No se encontró ningún dato para el perfíl activo",form_saved:"Formulario guardado"},confirm:{no:"No",yes_delete_everything:"Sí, eliminar todo",yes_overwrite_data:"Sí, sobrescribir los datos",overwrite_data:"¿Quiere realmente sobrescribir todos los datos?",hard_reset:"¿Quieres realmente resetear CMDI Maker por completo? ¡Todos los datos serán eliminados!"},on:"Encendido",off:"Apagado",ok:"OK",welcome_back:"¡Bienvenido de nuevo!",about:"Acerca de",save:"Guardar",export_to_file:"Exportar a archivo",open_file:"Abrir archivo",abort:"Annular",start:{greeting_text:"Bienvenidos al CMDI Maker!<br>Fígese, ésta es una aplicación que se puede utilizar también sin conexión.<br>Cuando cargue esta página, podrá reanudar su trabajo en el punto donde lo interrumpió.",and_lets_go__before_link:"¡y ",and_lets_go__link:"vamos a empezar",and_lets_go__after_link:"!",is_supported_by:"CMDI Maker está financiado por",need_help:"¿Necesita ayuda?",help_pages_description:"En las páginas de ayuda encontrará videos tutoriales, una lista de correo electrónico y de personas para consultar en caso de necesidad, ¡y mucho más!",select_your_profile:"Seleccione su perfíl",this_is:{before_language:"Esto es ",after_language:"!"}},language_search:{or_type_in_iso_code:"o bien ingresar un código ISO",search:"Buscar"},forms:{drag_and_drop_files_here:"Arrastrar y soltar los archivos aquí"},languages:{set_global_languages_of_content:"Establecer Content Language global",language_search:"Buscar lengua",result:"resultado",results:"resultados",language_name:"Nombre de la lengua",is_new_global:"es un nuevo Content Language global",iso_code:"Código ISO",not_found_in_db:"no se encontró en la base de datos",specify_search_request_at_least_3_chars:"Por favor especifique su búsqueda.\nIngrese por lo menos 3 caracteres.",primary_language:"Lengua principal",mother_tongue:"Lengua materna",current_content_languages:"Content Languages corrientes",content_language_removed__before_lang:'Content Language "',content_language_removed__after_lang:'" eliminada'}},APP.environments=function(){"use strict";var e=function(e){var n=getIndex(t.environments,"id",e.id);return"undefined"==typeof n?console.log("Environment "+e.id+" not found in APP.environments"):n},t={};return t.disabled_functions=[],t.environments=[],t.active_environment=void 0,t.isAnEnvironmentLoaded=function(){return"undefined"!=typeof t.active_environment?!0:!1},t.displayAllInSelect=function(){var e=g("profile_select"),n=g("start_profile_select");e&&n&&(dom.setSelectOptions(e,t.environments,"title","id",!0),dom.setSelectOptions(n,t.environments,"title","id",!1),n.addEventListener("change",function(){t.change(n.selectedIndex)}))},t.getModuleByViewID=function(e){if("undefined"!=typeof t.active_environment)for(var n=0;n<t.active_environment.workflow.length;n++)if(APP.CONF.view_id_prefix+t.active_environment.workflow[n].identity.id==e)return t.active_environment.workflow[n];return void 0},t.resetActive=function(){t.active_environment&&(t.active_environment.reset&&t.active_environment.reset(),forEach(t.active_environment.workflow,function(e){"undefined"!=typeof e.reset&&e.reset()}))},t.unloadActive=function(){return t.active_environment?(console.log("Unloading active environment: "+t.active_environment.id),APP.save(),g("environment_settings").innerHTML="",forEach(t.active_environment.workflow,function(e){dom.remove(APP.CONF.view_id_prefix+e.identity.id)}),g("functions").innerHTML="",g("module_icons").innerHTML="",t.active_environment=void 0,g("profile_select").selectedIndex=0,void APP.view("VIEW_start")):void console.warn("APP.environments.unloadActive called although there is no environment loaded!")},t.load=function(n){if("object"!=typeof n)return void console.warn("APP.environments.load: Environment parameter is invalid or undefined! typeof environment = "+typeof n);if("undefined"!=typeof t.active_environment){if(n.id==t.active_environment.id)return void console.log("Environment to be loaded is already active: "+t.active_environment.id);t.unloadActive()}t.active_environment=n,console.log("Creating environment: "+n.id),t.initSettings(n.settings()),n.init&&n.init(),t.createWorkflow(n.workflow);var i=e(n);g("profile_select").selectedIndex=i+1,g("start_profile_select").selectedIndex=i,APP.view("default")},t.initSettings=function(e){APP.settings.init(e,g("environment_settings"))},t.createWorkflow=function(e){forEach(e,t.createWorkflowModule),t.createWorkflowDisplay(e)
},t.createWorkflowModule=function(e){var n=dom.newElement("div",APP.CONF.view_id_prefix+e.identity.id,"content",g(APP.CONF.content_wrapper_id));e.functions&&t.initFunctions("function"==typeof e.functions?e.functions():e.functions),e.init&&e.init(n)},t.createWorkflowDisplay=function(e){for(var t=g("module_icons"),n=0;n<e.length;n++){if(0!==n){var i=dom.newElement("div","","wizard_arrow",t);APP.GUI.icon(i,"","wizard_icon","right2")}var r=dom.newElement("div",APP.CONF.viewlink_id_prefix+e[n].identity.id,"icon_div",t);APP.GUI.icon(r,"","module_icon",e[n].identity.icon),dom.br(r),dom.span(r,"","",e[n].identity.title),r.addEventListener("click",function(e){return function(){APP.view(e)}}(e[n]))}},t.getByID=function(e){return getObjectByID(t.environments,e)},t.get=function(e){return t.environments[e]},t.changeByID=function(e){var n=t.getIndexFromID(e);t.change(n)},t.change=function(e){if(APP.save(),-1==e)return void t.unloadActive();if("undefined"!=typeof t.active_environment){if(t.environments[e].id==t.active_environment.id)return void console.log("Environment does not have to be changed because it is already active: "+t.active_environment.id);t.unloadActive()}APP.GUI.scrollTop(),t.load(t.environments[e])},t.getIndexFromID=function(e){var n=getIndex(t.environments,"id",e);return"undefined"==typeof n&&console.error("ERROR: Unknown environment id: "+e),n},t.initFunctions=function(e){var n=g("functions");forEach(e,function(e){t.createFunction(n,e)})},t.disableFunction=function(e){-1==t.disabled_functions.indexOf(e)&&(t.disabled_functions.push(e),APP.GUI.showFunctionsForView(APP.environments.getModuleByViewID(APP.active_view)))},t.enableFunction=function(e){-1!=t.disabled_functions.indexOf(e)&&(t.disabled_functions.splice(t.disabled_functions.indexOf(e),1),APP.GUI.showFunctionsForView(APP.environments.getModuleByViewID(APP.active_view)))},t.createFunction=function(e,t){var n;if("function_wrap"!=t.type){n=dom.make("div",t.id,"function_icon",e),APP.GUI.icon(n,"","function_img",t.icon);var i=dom.h3(n,t.label);t.label_span_id?dom.make("span",t.label_span_id,"",i):t.label&&(i.innerHTML=t.label),n.addEventListener("click",t.onclick)}else{var r=dom.div(e,t.wrapper_id,"function_wrap");n=dom.div(r,t.id,"function_icon"),APP.GUI.icon(n,"","function_img",t.icon),dom.h3(n,t.label),n.addEventListener("click",t.onclick);var o=dom.make("div",t.sub_div,"function_sub_div",r);t.sub_div_innerHTML&&(o.innerHTML=t.sub_div_innerHTML),n.addEventListener("mousedown",function(e){return function(){e.style.backgroundColor="black"}}(n)),n.addEventListener("mouseup",function(e){return function(){e.style.backgroundColor=""}}(n))}t.after_that&&t.after_that()},t.add=function(e){t.environments.push(e),t.displayAllInSelect(),console.log("Environment available: "+e.id+", v"+e.version)},t}(),APP.forms=function(){"use strict";var e=function(e,t){var n;return n="undefined"!=typeof e?e:t.default_value?t.default_value:"check"==t.type?!1:"date"==t.type?{year:"YYYY",month:"MM",day:"DD"}:""},t=function(e,t){var n;return n=t.name&&""!==t.name?"undefined"!=typeof e&&e[t.name]?e[t.name]:void 0:e?e:void 0},n={text:function(e,t,n,i,r){var o;return o=APP.GUI.makeTextInput(e,t.heading,n+t.name,n+t.name,r&&r[t.name]?r[t.name]:t.default_value||"",t.comment,t.maxLength),r&&o.addEventListener("blur",function(){r[t.name]=o.value}),o},year:function(e,t,n,i,r){var o;return o=APP.GUI.makeYearInput(e,t.heading,n+t.name,n+t.name,r&&r[t.name]?r[t.name]:"YYYY",t.comment),r&&o.addEventListener("blur",function(){r[t.name]=o.value}),o},date:function(e,t,n,i,r){var o;o=APP.GUI.makeDateInput(e,t.heading,n+t.name,n+t.name,r&&r[t.name]?r[t.name].year:"",r&&r[t.name]?r[t.name].month:"",r&&r[t.name]?r[t.name].day:"",t.comment),r&&(o.year.addEventListener("blur",function(){r[t.name].year=o.year.value}),o.month.addEventListener("blur",function(){r[t.name].month=o.month.value}),o.day.addEventListener("blur",function(){r[t.name].day=o.day.value}));var a="0123456789";return o.year.onkeypress=function(e){var t=String.fromCharCode(e.which);return-1==a.indexOf(t)?(APP.log(APP.l("forms","this_character_is_not_allowed_here"),"error"),!1):void 0},o.month.onkeypress=function(e){var t=String.fromCharCode(e.which);return-1==a.indexOf(t)?(APP.log(APP.l("forms","this_character_is_not_allowed_here"),"error"),!1):void 0},o.day.onkeypress=function(e){var t=String.fromCharCode(e.which);return-1==a.indexOf(t)?(APP.log(APP.l("forms","this_character_is_not_allowed_here"),"error"),!1):void 0},o},textarea:function(e,t,n,i,r){var o;return o=APP.GUI.makeTextarea(APP.CONF.form_textarea_columns,APP.CONF.form_textarea_rows,e,t.heading,n+t.name,n+t.name,n+t.name,r&&r[t.name]?r[t.name]:t.default_value||"",t.comment),r&&o.addEventListener("blur",function(){r[t.name]=o.value}),o},subarea:function(e,t,n,i,r,a){var l=dom.h3(e,t.heading);t.comment&&(l.title=t.comment),t.fields&&(t.name&&""!==t.name&&(n+=t.name+"_"),o(t.fields,e,n,i,r?r[t.name]:void 0,a))},column:function(e,t,n,i,r,a){var l;l=t.name&&""!==t.name?t.name+"_td":"td";var s=dom.make("td",n+l,i+l,e);t.title&&""!==t.title&&dom.make("h2","","",s,t.title),t.fields&&(t.name&&""!==t.name&&(n+=t.name+"_"),o(t.fields,s,n,i,r?r[t.name]:void 0,a))},form:function(e,t,n,i,r,a){var l;if(t.fields&&"column"==t.fields[0].type){var s=dom.make("table",n+"table","session_table",e),c=dom.make("tr","","",s);l=c}else l=e;o(t.fields,l,n,i,r,a)},special:function(e,t,n,i,r,o){return o?void o(t,e,n,i):(console.error("APP.forms.make: Form Template has special fields, but no method on_special has been specified!"),console.error("field: "),console.error(t),void console.error("element_id_prefix: "+n))},select:function(e,t,n,i,r){var o;return o=APP.GUI.makeSelect(e,t.heading,n+t.name,n+t.name,t.size,t.vocabulary,r&&r[t.name]?r[t.name]:t.default_value,t.comment),r&&o.addEventListener("blur",function(){r[t.name]=get(o.name)}),o},open_vocabulary:function(e,t,n,i,r){var o,a;return r&&r[t.name]?o=r[t.name]:t.default_value&&(o=t.default_value),a=APP.GUI.openVocabulary(e,t.heading,n+t.name,n+t.name,t.size,t.vocabulary,o,t.comment),r&&(a.text.addEventListener("blur",function(){r[t.name]=a.text.value}),a.select.addEventListener("blur",function(){r[t.name]=get(a.select.name)})),a},check:function(e,t,n,i,r){var o;return o=APP.GUI.makeCheckbox(e,t.heading,n+t.name,n+t.name,r&&r[t.name]?r[t.name]:!1,t.comment),r&&o.addEventListener("blur",function(){console.log(o),r[t.name]=o.checked}),o}},i=function(e,t){t[e.name]=e.default_value?e.default_value:""},r={select:i,open_vocabulary:i,textarea:i,text:i,year:function(e,t){t[e.name]=e.default_value?e.default_value:"YYYY"},check:function(e,t){t[e.name]=!1},form:function(e){var t={};return a(e.fields,t),t},column:function(e,t){var n;e.name&&""!==e.name?(n={},t[e.name]=n):n=t,a(e.fields,n)},subarea:function(e,t){var n=e.name;t[n]={},a(e.fields,t[n])},date:function(e,t){var n={year:"",month:"",day:""};t[e.name]=n},special:function(e,t){"array"==e.object_structure?t[e.name]=[]:"object"==e.object_structure?(t[e.name]={},e.object_arrays&&forEach(e.object_arrays,function(n){t[e.name][n]=[]})):t[e.name]=null}},o=function(e,t,n,i,r,o){forEach(e,function(e){s.make(t,e,n,i,r,o)})},a=function(e,t){"undefined"!=typeof e&&forEach(e,function(e){s.createEmptyObjectFromTemplate(e,t)})},l=function(e,t,n){forEach(e,function(e){s.fillObjectWithFormData(t,n,e)})},s={};return s.make=function(e,t,i,r,o,a){var l;return n[t.type]?(l=n[t.type](e,t,i,r,o,a),t.not_allowed_chars&&(l.onkeypress=function(e){var n=String.fromCharCode(e.which);return t.not_allowed_chars.indexOf(n)>=0?(APP.log(APP.l("forms","this_character_is_not_allowed_here"),"error"),!1):void 0},l.addEventListener("blur",function(e){var n=strings.removeCharactersFromString(e.target.value,t.not_allowed_chars);l.value=n})),void(t.allowed_chars&&(l.onkeypress=function(e){var n=String.fromCharCode(e.which);return-1==t.allowed_chars.indexOf(n)&&0!=e.charCode?(APP.log(APP.l("forms","this_character_is_not_allowed_here"),"error"),!1):void 0},l.addEventListener("blur",function(e){var n=e.target.value;t.replace_accent_bearing_letters_with_asci_substitute&&1==t.replace_accent_bearing_letters_with_asci_substitute&&(n=strings.replaceAccentBearingLettersWithASCISubstitute(n)),n=strings.removeAllCharactersFromStringExcept(n,t.allowed_chars),l.value=n})))):void console.error("ERROR: APP.forms.make: Field type not supported! Field type = "+t.type)},s.fill=function(n,i,r,o){var a;("column"==n.type||"subarea"==n.type)&&n.name&&""!==n.name&&(i+=n.name+"_"),("form"==n.type||"subarea"==n.type||"column"==n.type)&&forEach(n.fields,function(e){a=t(r,e),s.fill(e,i,a)}),("year"==n.type||"text"==n.type||"textarea"==n.type||"select"==n.type||"open_vocabulary"==n.type||"check"==n.type)&&(a=e(r,n),APP.GUI.setFormValue(i+n.name,a,n.vocabulary)),"date"==n.type&&(a=e(r,n),g(i+n.name+"_year").value=""!=a.year?a.year:"YYYY",g(i+n.name+"_month").value=""!=a.month?a.month:"MM",g(i+n.name+"_day").value=""!=a.day?a.day:"DD"),"special"==n.type&&o&&o(n,i,r)},s.createEmptyObjectFromTemplate=function(e,t){return r[e.type]?r[e.type](e,t):void console.log("ERROR: createEmptyObjectFromTemplate: field.type not defined: "+e.type)},s.makeObjectWithFormData=function(e,t){var n=s.createEmptyObjectFromTemplate(e);return s.fillObjectWithFormData(n,t,e),n},s.fillObjectWithFormData=function(e,t,n,i){var r;return n?e?(("year"==n.type||"text"==n.type||"textarea"==n.type||"select"==n.type||"open_vocabulary"==n.type)&&(e[n.name]=get(t+n.name)),"check"==n.type&&(e[n.name]=g(t+n.name).checked),"date"==n.type&&(e[n.name].year=get(t+n.name+"_year"),e[n.name].month=get(t+n.name+"_month"),e[n.name].day=get(t+n.name+"_day")),"column"==n.type&&(n.name&&""!==n.name&&(t+=n.name+"_"),l(n.fields,e,t)),"subarea"==n.type&&(n.name&&""!==n.name&&(t+=n.name+"_"),l(n.fields,e[n.name],t)),"form"==n.type&&forEach(n.fields,function(n){r=n.name&&""!==n.name&&"column"==n.type?e[n.name]:e,s.fillObjectWithFormData(r,t,n)}),void("special"==n.type&&i&&i(e,t,n))):void console.error("fillObjectWithFormData: object is undefined. element_id_prefix = "+t):void console.error("fillObjectWithFormData: FIELD is undefined. element_id_prefix = "+t)},s}(),APP.GUI=function(){var e=APP.l,t={};return t.showBusyIndicator=function(e){g("busy_div")&&dom.remove("busy_div"),e.innerHTML="";var t=dom.div(e,"busy_div","busy_div"),n=dom.p(t,"","","center"),i=dom.img(n,"busy_icon","busy_icon","img/busy.svg");i.width="700",i.height="300"},t.hideBusyIndicator=function(){dom.remove("busy_div"),g("environment_view").style.display="block"},t.setIcon=function(e,t){e.src=APP.CONF.path_to_icons+t+".png"},t.setFormValue=function(e,n,i){var r,o=g(e);if(!o)return void console.error("setFormValue: No element found! element_id = "+e);if("SELECT"==o.nodeName){var a=[];forEach(o.options,function(e){a.push(e.value)}),-1==a.indexOf(n)?(r=t.changeOVInput(e,a),r.value=n):o.value=n}else"text"==o.type&&i&&-1!=i.indexOf(n)?(r=t.changeOVInput(e,i),r.value=n):"checkbox"==o.type?o.checked=n:o.value=n},t.makeTextInput=function(e,t,n,i,r,o,a){var l=dom.spanBR(e,"","",t);o&&(l.title=o);var s=dom.input(e,i,"",n,"text",r);return o&&(s.title=o),a&&(s.maxLength=a),dom.br(e),s},t.makeYearInput=function(e,t,n,i,r,o){var a=dom.spanBR(e,"","",t);o&&(a.title=o);var l=dom.input(e,i,"YearInput",n,"text",""!==r?r:"YYYY");return o&&(l.title=o),l.maxLength=4,dom.br(e),l},t.makeCheckbox=function(e,t,n,i,r,o){var a=dom.input(e,i,"",n,"checkbox");a.checked=r,o&&(a.title=o);var l=dom.spanBR(e,"","",t);return o&&(l.title=o),a},t.openVocabulary=function(e,n,i,r,o,a,l,s,c){if(s||(s=""),"undefined"!=typeof n){var d=dom.spanBR(e,"","",n);d.title=s}var u=document.createElement("select");u.name=i,u.id=r,u.className=c,u.size=o,s&&(u.title=s),dom.setSelectOptions(u,a),u.selectedIndex="undefined"!=typeof l&&-1!=a.indexOf(l)?a.indexOf(l):0;var f=document.createElement("input");f.name=i,f.id=r,f.className=c,f.type="text",s&&(f.title=s),"undefined"==typeof l||-1!=a.indexOf(l)?e.appendChild(u):(f.value=l,e.appendChild(f));var g=t.icon(e,"","edit_img","textedit");g.alt="Custom Property",g.title="Custom Property",g.addEventListener("click",function(){document.contains(u)?(dom.remove(u),e.insertBefore(f,g)):(dom.remove(g.previousSibling),e.insertBefore(u,g))}),dom.br(e);var v={text:f,select:u};return v},t.makeLanguageSearchForm=function(n,i,r,o,a){var l=APP.doStandardLanguageSearch,s=t.addLanguageByISOCode,c=dom.make("p","","",n),d=dom.make("input",i+"input","language_input",c);d.type="text",d.size=1,d.name=i+"input",dom.make("span","","",c," ");var u=dom.make("input",i+"search_button","language_search_button",c);u.type="button",u.value=e("language_search","search"),r&&r===!0?dom.make("span","","",c," "):dom.br(c),dom.make("span","","",c,e("language_search","or_type_in_iso_code")+" ");var f=dom.make("input",i+"iso_input","language_iso_input",c);f.type="text",f.size=1,f.name=i+"iso_input",dom.make("span","","",c," ");var g=dom.make("input",i+"iso_ok","language_iso_add_button",c);g.type="button",g.value=e("ok"),o||dom.make("div",i+"display","",n),u.addEventListener("click",function(){l(d.value,a)}),g.addEventListener("click",function(){s(f,a)}),d.onkeydown=function(e){13==e.keyCode&&l(d.value,a)},f.onkeydown=function(e){13==e.keyCode&&s(f,a)}},t.addLanguageByISOCode=function(n,i){var r=n.value.toLowerCase();console.log("ADDING ISO LANGUAGE "+r);for(var o=0;o<LanguageIndex.length;o++)if(LanguageIndex[o][0]==r&&"L"==LanguageIndex[o][2])return i(LanguageIndex[o]),void(n.value="");return t.isISOCodeReservedForLocalUse(r)===!0?(i([r,"","LOCAL",""]),void(n.value="")):void APP.alert(e("languages","iso_code")+" "+r+" "+e("languages","not_found_in_db")+".")},t.isISOCodeReservedForLocalUse=function(e){return 3!=e.length?!1:"q"!=e[0]?!1:-1=="abcdefghijklmnopqrst".indexOf(e[1])?!1:-1=="abcdefghijklmnopqrstuvwxyz".indexOf(e[2])?!1:!0},t.icon=function(e,n,i,r,o){var a=dom.make("img",n,i,e);return t.setIcon(a,r),o&&a.addEventListener("click",o,!1),a},t.copyField=function(e,n){var i=get(n),r=document.getElementsByName(n)[0],o=document.getElementsByName(e)[0];if(r.nodeName!=o.nodeName){var a;"SELECT"==r.nodeName&&(a=t.getOptionValuesOfSelect(r));var l=document.createElement(r.nodeName);l.name=o.name,l.className=o.className,o.parentNode.insertBefore(l,o),dom.remove(o),"SELECT"==l.nodeName?(dom.setSelectOptions(l,a),l.selectedIndex=a.indexOf(i)):l.value=i}else o.value=i},t.changeOVInput=function(e,t){var n,i=g(e);return"SELECT"==i.nodeName?(n=document.createElement("input"),n.type="text"):(n=document.createElement("select"),dom.setSelectOptions(n,t)),n.id=i.id,n.name=i.name,n.className=i.className,i.parentNode.insertBefore(n,i),dom.remove(i),n},t.makeSelect=function(e,t,n,i,r,o,a,l){l||(l="");var s=dom.spanBR(e,"","",t);s.title=l;var c=document.createElement("select");return c.name=n,c.id=i,c.size=r,c.title=l,e.appendChild(c),dom.br(e),dom.setSelectOptions(c,o),c.selectedIndex="undefined"!=typeof a&&-1!=o.indexOf(a)?o.indexOf(a):0,c},t.makeDateInput=function(e,t,n,i,r,o,a,l){var s;l||(l=""),s=dom.spanBR(e,"","",t),s.title=l;var c=dom.input(e,i+"_year","YearInput",n+"_year","text",""!==r?r:"YYYY");c.title=l,c.maxLength=4,s=dom.span(e,"",""," "),s.title=l;var d=dom.input(e,i+"_month","MonthInput",n+"_month","text",""!==o?o:"MM");d.title=l,d.maxLength=2,s=dom.span(e,"",""," "),s.title=l;var u=dom.input(e,i+"_day","DayInput",n+"_day","text",""!==a?a:"DD");return u.title=l,u.maxLength=2,dom.br(e),return_object={year:c,month:d,day:u}},t.makeTextarea=function(e,t,n,i,r,o,a,l,s){s||(s="");var c=dom.spanBR(n,"","",i);c.title=s;var d=dom.make("textarea",o,a,n);return d.name=r,d.value=l,d.cols=e,d.rows=t,d.title=s,dom.br(n),d},t.makeAllFunctionsInvisible=function(){var e=g(APP.CONF.functions_div_id).children;forEach(e,dom.hideElement)},t.hideFunctionsDIV=function(){g(APP.CONF.functions_div_id).style.height="0px",g(APP.CONF.content_wrapper_id).style.bottom="0px",g(APP.CONF.log_section_id)&&(g(APP.CONF.log_section_id).style.bottom="10px")},t.showFunctionsDIV=function(){g(APP.CONF.functions_div_id).style.height=APP.CONF.functions_div_height,g(APP.CONF.content_wrapper_id).style.bottom=APP.CONF.functions_div_height,g(APP.CONF.log_section_id)&&(g(APP.CONF.log_section_id).style.bottom="50px")},t.showFunctionsForView=function(e){if(t.makeAllFunctionsInvisible(),!e)return void t.hideFunctionsDIV();if(e.functions){t.showFunctionsDIV();var n=e.functions;"function"==typeof n&&(n=n()),forEach(n,t.renderFunctionIfNotDisabled)}},t.renderFunctionIfNotDisabled=function(e){var n;n="function_wrap"==e.type?e.wrapper_id:e.id,-1==APP.environments.disabled_functions.indexOf(n)&&t.renderFunction(e)},t.renderFunction=function(e){if("function_wrap"==e.type){g(e.wrapper_id).style.display="inline";var t=g(e.wrapper_id).children[0].getBoundingClientRect();g(e.wrapper_id).children[1].style.left=t.left+"px",g(e.wrapper_id).children[1].style.minWidth=t.width-30+"px"}else g(e.id).style.display="inline"},t.closeSelectFrame=function(){if(g(APP.CONF.select_frame_id)){var e=g(APP.CONF.select_frame_id).parentNode;dom.showAllChildren(e),dom.remove(APP.CONF.select_frame_id);var n=APP.environments.getModuleByViewID(e.id);t.showFunctionsForView(n)}},t.switchToggle=function(e){e.on===!1?t.setToggleValue(e,!0):t.setToggleValue(e,!1)},t.setToggleValue=function(e,t){t===!0?(e.value=APP.l("on"),e.style.backgroundColor=APP.CONF.toggle_color_on,e.on=!0):(e.value=APP.l("off"),e.style.backgroundColor=APP.CONF.toggle_color_off,e.on=!1)},t.showSelectFrame=function(e,n,i,r,o){t.closeSelectFrame();var a=g(APP.active_view);dom.hideAllChildren(a);var l=dom.make("div",APP.CONF.select_frame_id,APP.CONF.select_frame_id,a,"");l.style.display="block",dom.make("h1","","",l,r);var s=dom.make("img","","close_select_frame_icon",l);s.src=APP.CONF.path_to_icons+"reset.png",s.addEventListener("click",function(){t.closeSelectFrame()}),dom.h3(l,o);for(var c=0;c<e.length;c++){var d=dom.link(l,"cl_results_link_"+c,"cl_results_link","",function(e){return function(){t.closeSelectFrame(),i(e)}}(e[c]));dom.make("div","","SF_search_entry",d,n[c])}t.makeAllFunctionsInvisible()},t.scrollTop=function(){dom.scrollTop(g(APP.CONF.content_wrapper_id))},t.createXMLOutputDIV=function(e,n,i,r,o,a,l){var s=dom.make("div","","output_div",e),c=t.icon(s,"","download_icon xml_output_area_icon","save");if("undefined"!=typeof l){var d=t.icon(s,"","download_icon xml_output_area_icon","send_mail");d.title="Post data to server"}var u=dom.h1(s,n),f=dom.textarea(s,i,APP.CONF.xml_textarea_class_name,APP.CONF.output_textarea_rows,APP.CONF.output_textarea_columns,r);if(f.filename=o,c.addEventListener("click",function(){APP.saveTextfile(f.value,o,APP.CONF.file_download_header)}),"undefined"!=typeof l){var g=l.xml_string_key+"='"+f.value+"'&"+l.additional_data;d.addEventListener("click",function(){postWithAJAX(l.url,g,function(){APP.log("Data saved on server!","success")})})}a&&a===!0&&(console.warn("Created invalid XML"),s.style.backgroundColor="tomato",u.style.color="#AA0000",f.style.color="red",u.innerHTML+=" - INVALID XML!",f.value="############################################################################\nWARNING: THE FOLLOWING XML IS NOT VALID AND MEANT ONLY FOR TESTING PURPOSES!\n############################################################################\n"+r,dom.remove(c))},t.highlightViewIcon=function(e){"undefined"!=typeof APP.environments.active_environment&&forEach(APP.environments.active_environment.workflow,function(e){g(APP.CONF.viewlink_id_prefix+e.identity.id).style.backgroundColor=""}),g(APP.CONF.viewlink_id_prefix+"start").style.backgroundColor="";var t=APP.environments.getModuleByViewID(e);t?g(APP.CONF.viewlink_id_prefix+t.identity.id).style.backgroundColor=APP.CONF.highlight_color:"VIEW_start"==e&&(e=e.substr(APP.CONF.view_id_prefix.length),g(APP.CONF.viewlink_id_prefix+e).style.backgroundColor=APP.CONF.highlight_color)},t.mainMenu=function(){var e={};return e.drawElement=function(t,n){var i=dom.div(n,t.id,"main_menu_entry");APP.GUI.icon(i,"","main_menu_entry_img",t.icon),dom.span(i,"","main_menu_entry_span",t.title),i.addEventListener("click",t.onclick,!1),i.addEventListener("click",e.close,!1)},e.draw=function(t){var n;g(APP.CONF.main_menu_div_id)?(n=g(APP.CONF.main_menu_div_id),n.innerHTML=""):n=dom.div(document.body,APP.CONF.main_menu_div_id,""),forEach(t,function(t){e.drawElement(t,n)}),e.close(),g("main_menu_icon").addEventListener("click",e.changeDisplay),g("content_wrapper").addEventListener("click",e.close)},e.changeDisplay=function(){"none"==g(APP.CONF.main_menu_div_id).style.display?e.open():e.close()},e.close=function(){g(APP.CONF.main_menu_div_id)&&(dom.hideElement(g(APP.CONF.main_menu_div_id)),g("main_menu_icon").style.backgroundColor="")},e.open=function(){g(APP.CONF.main_menu_div_id).style.display="block",g("main_menu_icon").style.backgroundColor="cornflowerblue"},e}(),t.showFileDialog=function(e){alertify.set({labels:{ok:APP.l("abort")}});var t="<input type='file' id='generic_file_input'>";alertify.alert(t),g("generic_file_input").addEventListener("change",function(t){var n=t.target.files[0];e(n),g("alertify-ok").click()})},t.selectionMechanism=function(e,t,n){var i=this;this.shift=!1,this.last_selected_file=-1,this.selected_files=[],this.selectFile=function(e){var t=i.selected_files.indexOf(e);-1==t?(i.selected_files.push(e),i.last_selected_file=e):(i.selected_files.splice(t,1),i.last_selected_file=e),i.markFileEntry(e)},this.markFileEntry=function(i){var r,o=g(e+i).className.indexOf(" "+t);-1==o?(g(e+i).className=g(e+i).className+" "+t,r={index:i,selected:!0}):(g(e+i).className=g(e+i).className.slice(0,o),r={index:i,selected:!1}),n(r)},this.deselectAllFiles=function(){for(;i.selected_files.length>0;)i.selectFile(i.selected_files[0])},this.clickedOnFile=function(e){var t;if(i.shift===!0){if(e<i.last_selected_file)for(t=i.last_selected_file-1;t>=e;t--)i.selectFile(t);if(e>i.last_selected_file)for(t=i.last_selected_file+1;e>=t;t++)i.selectFile(t)}else i.selectFile(e)},document.onkeydown=function(e){16==e.keyCode&&i.shift===!1&&(i.shift=!0,console.log("shift on")),27==e.keyCode&&i.deselectAllFiles()},document.onkeyup=function(e){16==e.keyCode&&(i.shift=!1,console.log("shift off"))}},t}(),APP.GUI.FORMS=function(){var e=APP.l,t={};return t.fileDropZone=function(t,n,i){var r=dom.make("div",n,"fileDropZone",t,"<h2>"+e("forms","drag_and_drop_files_here")+"</h2>"),o=dom.input(t,"files_input","","files_input","file");o.multiple=!0,r.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),r.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),i(e.dataTransfer.files)},!1),g("files_input").addEventListener("change",function(e){i(e.target.files)},!1)},t.redBox=function(e,t,n,i,r,o){var a=dom.div(e,t,"redBox");"undefined"!=typeof n&&(a.className+=" ",a.className+=n),APP.GUI.icon(a,"","delete_lang_icon","reset",r);var l=dom.div(a,"","redBox_content");return forEach(i,function(e){var t=dom.spanBR(l,"","","");dom.appendHTMLContent(t,e)}),a.style.width=o+"px",{box:a,content:l}},t.expandableForm=function(e,n,i,r,o,a){var l=dom.make("div",n,"expandable_form",e),s=dom.make("div",n+"_header","expandable_form_header",l);s.addEventListener("click",function(e,n){return function(){t.expandableFormViewChange(e,r,n)}}(n,a));var c=dom.make("h1",n+"_label","expandable_form_heading",s),d=APP.GUI.icon(s,n+"_delete_link","expandable_form_delete_link","reset",function(e){return function(t){t.stopPropagation(),o(e)}}(n));d.innerHTML='<img id="'+n+'_delete_img" class="delete_img" src="'+APP.CONF.path_to_icons+'reset.png" alt="Delete Bundle">';var u=APP.GUI.icon(s,n+"_display_link","expandable_form_display_link","down");APP.GUI.icon(u,n+"_expand_img","expand_img","down");var f=dom.make("div",n+"_content","expandable_form_content",l);return 0==i&&t.collapseExpandableForm(n),{form:l,header:s,label:c,content:f,delete_icon:d,display_icon:u}},t.collapseExpandableForm=function(e){dom.hideElement(g(e+"_content")),APP.GUI.setIcon(g(e+"_display_link"),"up")},t.expandableFormViewChange=function(e,n,i){var r=g(e+"_content");if("none"!=r.style.display){t.collapseExpandableForm(e);var o={id:i,expanded:!1}}else{dom.unhideElement(r),APP.GUI.setIcon(g(e+"_display_link"),"down");var o={id:i,expanded:!0}}n(o)},t.clickableListSmall=function(e,t,n,i,r,o){var a=this;this.parent=e,this.titles=t,this.subtitles=n,this.action=i,this.id=r,this.highlighted_index=o,this.scrollTop,this.list_div;var l=function(e,t,n,i,r){var o=dom.make("div","","clickable_list_entry",a.list_div);return r&&(o.className+=" clickable_list_entry_highlighted"),dom.h2(o,t),dom.p(o,n),o.addEventListener("click",i,!1),o},s=function(){g(r)||(a.list_div=dom.make("div",r,"clickable_list_small",e),a.list_div.addEventListener("scroll",function(){a.scrollTop=a.list_div.scrollTop},!1));var t=[];a.list_div.innerHTML="";for(var n=0;n<a.titles.length;n++){if("undefined"!=typeof a.subtitles)var i=a.subtitles[n];else i="";var o=l(a.list_div,a.titles[n],i,function(e){return function(){a.action(e)}}(n),a.highlighted_index==n);t.push(o)}return a.list_div.scrollTop=a.scrollTop,t};this.elements=s(e,t,n,i,o),this.changeHighlight=function(e){a.highlighted_index=e,s()},this.refresh=function(e,t){a.titles=e,a.subtitles=t,s()}},t}(),APP.GUI.pager=function(e){var t=this;this.current_page=e.start_page||0,this.items_per_page=e.items_per_page||20,this.view=e.view,this.items_list=e.items_list,this.on_page_change=e.on_page_change,this.show_always=e.show_always||!1,this.before_page_change=e.before_page_change;var n=function(){return t.items_count=t.items_list.length,t.page_count=Math.ceil(t.items_count/t.items_per_page),0==t.page_count&&(t.page_count=1),t.start_item=t.current_page*t.items_per_page,t.end_item=t.start_item+t.items_per_page-1,t.items_list.length<t.end_item+1&&(t.end_item=t.items_list.length-1),0==t.items_list.length&&(t.end_item=0),t.visible_items=t.items_list.slice(t.start_item,t.start_item+t.items_per_page),t.current_page==t.page_count-1&&(t.visible_items=t.items_list.slice(t.start_item)),0==t.items_list.length&&(t.visible_items=[]),t.current_page>=t.page_count?void t.changePage(t.page_count-1):void 0};this.refresh=function(e){if(t.items_list=e,n(),t.hide(),(t.items_count>t.items_per_page||1==t.show_always)&&g(APP.active_view)==t.view){var i=dom.div(g("environment_view"),"pager","pager","Page: ");g("content_wrapper").style.bottom="84px";for(var r=0;r<t.page_count;r++){var o=dom.span(i,"page_link_"+r,"page_link",r+1);r==t.current_page&&(o.className+=" page_link_active"),o.addEventListener("click",function(e){return function(){t.changePage(e),t.refresh(t.items_list)}}(r),!1)}if(0!=t.items_count)var a="Showing items "+(t.start_item+1)+"-"+(t.end_item+1)+" of "+t.items_list.length;else a="";dom.span(i,"pager_info_span","",a)}},this.changePage=function(e){"function"==typeof t.before_page_change&&t.before_page_change(),t.current_page=e,t.on_page_change(t.items_list),APP.GUI.scrollTop()},this.hide=function(){g("pager")&&(dom.remove("pager"),g("content_wrapper").style.bottom="")},n()},APP.save_and_recall=function(){"use strict";var e={};return e.interval=void 0,e.interval_time=60,e.getRecallDataForApp=function(){var t=localStorage.getItem(APP.CONF.local_storage_key);if(!t)return console.log("No recall data found"),e.setAutosaveInterval(e.interval_time),void APP.view("default");var n=JSON.parse(t);return console.log("APP Recall object found!"),n},e.getRecallDataForEnvironment=function(e){if("undefined"==typeof e)return void console.warn("getRecallDataForEnvironment: environment is undefined!");var t=localStorage.getItem(e.id);if(!t)return void console.log("No recall data for environment found");var n=JSON.parse(t);return console.log("Environment Recall object found!"),n},e.setAutosaveInterval=function(t){return window.clearInterval(e.interval),t?-1==t?void console.log("Auto Save off"):(console.log("Auto Save Time in seconds: "+t),e.interval_time=t,void(e.interval=window.setInterval(function(){e.save()},1e3*e.interval_time))):void console.error("ERROR: setAutosaveInterval called without time parameter!")},e.recallEnvironmentData=function(e){APP.environments.active_environment.recall(e.settings);var t=APP.environments.active_environment.workflow;forEach(t,function(t){t.recall&&t.recall(e[t.identity.id])})},e.deleteAllData=function(){localStorage.clear()},e.deleteEnvironmentData=function(){try{localStorage.removeItem(APP.environments.active_environment.id)}catch(e){return void APP.log(APP.l("save_and_recall","no_data_found"))}APP.log(APP.l("save_and_recall","active_profile_data_deleted"))},e.userSave=function(){e.save(),APP.log(APP.l("save_and_recall","form_saved"))},e.save=function(){var t=e.retrieveAppDataToSave();if(localStorage.setItem(APP.CONF.local_storage_key,JSON.stringify(t)),APP.environments.active_environment){var n=e.retrieveEnvironmentDataToSave();localStorage.setItem(APP.environments.active_environment.id,JSON.stringify(n))}console.log("Form saved")},e.saveAllToFile=function(){var t={};if(t[APP.CONF.app_core_storage_key]=e.retrieveAppDataToSave(),APP.environments.active_environment){var n=e.retrieveEnvironmentDataToSave();t.environments={},t.environments[APP.environments.active_environment.id]=n}APP.saveTextfile(JSON.stringify(t),APP.CONF.project_file_name)},e.saveActiveEnvironmentStateToFile=function(){if(APP.environments.isAnEnvironmentLoaded()){var t;t=APP.environments.active_environment.getProjectName&&""!==APP.environments.active_environment.getProjectName()?APP.environments.active_environment.getProjectName()+"."+APP.CONF.project_file_extension:APP.CONF.project_file_name+"."+APP.CONF.project_file_extension;var n={};n.type="environment_state",n.environment_id=APP.environments.active_environment.id,n.environment_version=APP.environments.active_environment.version;var i=e.retrieveEnvironmentDataToSave();n.environments={},n.environments[APP.environments.active_environment.id]=i,APP.saveTextfile(JSON.stringify(n),t)}else APP.log(APP.l("save_and_recall","no_data_to_save_no_profile_loaded"),"error")},e.handleProjectFileInputChange=function(t){e.loadFromFile(t.target.files[0])},e.loadFromFile=function(t){readFileAsJSON(t,e.importProjectData,function(){APP.log(APP.l("settings","no_project_data_found_in_file"),"error")})},e.importProjectData=function(t){if(t[APP.CONF.app_core_storage_key]){console.log("data.app_storage_key = "+t[APP.CONF.app_core_storage_key]);var n;return alertify.set({labels:{ok:APP.l("confirm","no"),cancel:APP.l("confirm","yes_overwrite_data")}}),void alertify.confirm(APP.l("confirm","overwrite_data"),function(e){if(!e){console.log("Importing CMDI Maker Project from file!"),APP.environments.unloadActive(),APP.init(!0);var i=t[APP.CONF.app_core_storage_key].active_environment_id;console.log("Active Environment: "+i),t.environments&&t.environments[i]&&(console.log("importProjectData: Found environment data of environment: "+i),n=t.environments[i]),APP.recall(t[APP.CONF.app_core_storage_key],n)}})}return console.info("No app_storage_key found in file. looking for type=environment_state"),"environment_state"==t.type?(console.log("found environment_state"),void APP.confirm(APP.l("confirm","overwrite_data"),function(i){if(!i){var r=t.environment_id;return APP.environments.changeByID(t.environment_id),t.environments&&t.environments[r]&&(console.log("importProjectData: Found environment data of environment: "+r),n=t.environments[r]),void e.recallEnvironmentData(n)}},APP.l("confirm","no"),APP.l("confirm","yes_overwrite_data"))):void console.warn("Tried to import project data, but no vaild data was found!")},e.retrieveAppDataToSave=function(){var e={settings:{save_interval_time:dom.getSelectedRadioValue(g("radio_auto_save")),active_language_id:APP.active_language.id}};return e.active_view=APP.active_view,e.scroll_top=g(APP.CONF.content_wrapper_id).scrollTop,e.version=APP.CONF.version,APP.environments.active_environment&&(e.active_environment_id=APP.environments.active_environment.id),e},e.retrieveEnvironmentDataToSave=function(){var e={};e.settings=APP.environments.active_environment.getSaveData();
var t=APP.environments.active_environment.workflow;return forEach(t,function(t){t.getSaveData&&(e[t.identity.id]=t.getSaveData())}),e},e}(),APP.settings=function(){"use strict";var e={};return e.makeFunctions={radio:function(e,t){dom.makeRadios(t,e.options,e.radio_name,e.radio_name+"_","title","value",e.default_option,e.onchange)},select:function(e,t){var n=dom.make("select",e.id,"",t);n.size=1,n.name=e.name,e.onchange&&n.addEventListener("change",e.onchange,!1),dom.br(t)},toggle:function(e,t){var n=dom.input(t,e.id,"on_off_switch",e.name,"button");n.on=!1,n.addEventListener("click",function(){APP.GUI.switchToggle(this)},!1),APP.GUI.setToggleValue(g(e.id),e.default_value),dom.br(t)},file:function(e,t){var n=dom.input(t,e.file_input_id,"",e.file_input_name,"file");n.addEventListener("change",e.onchange,!1),dom.br(t)},text:function(e,t){var n=dom.input(t,e.id,"",e.name,"text",e.value);n.addEventListener("change",e.onchange,!1),dom.br(t)},empty:function(e,t){dom.make("div",e.id,"",t)},link:function(){}},e.init=function(t,n){n.innerHTML="",forEach(t,function(t){e.create(t,n)})},e.create=function(t,n){var i=dom.h2(n);if(t.importance&&"high"==t.importance&&(i.style.color="red"),t.onclick){var r=dom.link(i,"","",t.title,t.onclick);t.importance&&"high"==t.importance&&(r.style.color="red")}else i.innerHTML=t.title;t.description&&dom.make("p","","",n,t.description),e.makeFunctions[t.type]?e.makeFunctions[t.type](t,n):console.warn("Unknown setting type: "+t.type),dom.br(n)},e}(),APP.CONF={originator:"CMDI Maker by CLASS - Cologne Language Archive Services",version:"2.1.1",LanguageCodePrefix:"ISO639-3:",path_to_images:"img/",path_to_icons:"img/icons/",path_to_scripts:"js/",file_download_header:"text/xml;charset=utf-8",highlight_color:"skyblue",local_storage_key:"CMDI-Maker",project_file_name:"CMDI-Maker-Project",project_file_extension:"cmp",zip_archive_file_name:"archive.zip",content_wrapper_id:"content_wrapper",app_core_storage_key:"app",copy_checkbox_element_prefix:"copy_check_",viewlink_id_prefix:"VIEWLINK_",view_id_prefix:"VIEW_",xml_textarea_class_name:"xml_textarea",select_frame_id:"SF",main_menu_div_id:"main_menu_div",functions_div_id:"functions",functions_div_height:"44px",toggle_color_on:"limegreen",toggle_color_off:"tomato",output_textarea_rows:40,output_textarea_columns:130,form_textarea_rows:6,form_textarea_columns:18,log_message_period:5e3,log_section_id:"alertify-logs",language_error_placeholder:"###",url_for_version_check:"get_version.php",languageIndex_filename:"LanguageIndex.js",hellos:[["Hello!","English"],["Hallo!","German"],["Aloha!","Hawaiian"],["Hola!","Spanish"],["Hej!","Danish"],["Merhaba!","Turkish"],["你好","Chinese"],["こんにちは","Japanese"],["Вiтаю!","Belarusian"],["Salut!","French"],["Grüezi!","Swiss German"],["Ciao!","Italian"],["Hæ!","Icelandic"],["Moïen!","Luxembourgish"],["Olá!","Portuguese"],["Privet!","Russian"],["Hallå!","Scanian"],["Salam!","Urdu"]]};